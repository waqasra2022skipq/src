#!/usr/bin/perl
############################################################################
use lib '/var/www/okmis/src/lib';
use myConfig;
use DBI;
use myForm;
use myDBI;
use DBA;
use MgrTree;
use DBUtil;
use Time::Local;

use PDFlib::PDFlib;
use strict;

############################################################################
my $form = myForm->new();
my $dbh = myDBI->dbconnect($form->{'DBNAME'});
my $cdbh = myDBI->dbconnect('okmis_config');
my $table = $form->{'action'};
my $page = $form->{'page'};
#warn "PrintPHQ: IDs=$form->{'IDs'}\n";
##
my $sPHQ = $dbh->prepare("select * from ${table} where ID=?");
my $sClient = $dbh->prepare("select * from Client where ClientID=?");
my $sProvider = $dbh->prepare("select * from Provider where ProvID=?");
my $sxTables = $cdbh->prepare("select xTables.theTable,xTableFields.* from xTables left join xTableFields on xTableFields.TableID=xTables.ID where xTables.theTable=? and xTableFields.theField=?");

############################################################################
my $searchpath = "../data";

my $pagewidth = 612;
my $pageheight = 792;
my $fontname= "Arial";
my $boldfontname= "Arial-BoldMT";
my $fontsizesmall = 8;
my $fontsize = 9;
my $fontsizemid = 10;
my $fontsizelarge = 11;
my $fontsizemidlarge = 12;
my $fontsizexlarge = 13;
my $fontsizemidxlarge = 14;
my $fontsizexxlarge = 15;
my $basefontoptions = "fontname=" . $fontname . " fontsize=" . $fontsize . " embedding encoding=unicode charref";
my $basefontoptions_i = $basefontoptions . " fontstyle=italic";
my $basefontoptions_u = $basefontoptions . " underline=true underlineposition=-15% underlinewidth=0.3";
my $baseboldfontoptions = "fontname=" . $boldfontname . " fontsize=" . $fontsize . " embedding encoding=unicode";
my $baseboldfontoptions_u = $baseboldfontoptions . " underline=true underlineposition=-15% underlinewidth=0.3";
my $basemidfontoptions = $basefontoptions . " fontsize=" . $fontsizemid;
my $basemidfontoptions_i = $basemidfontoptions . " fontstyle=italic";
my $basemidfontoptions_u = $basemidfontoptions . " underline=true underlineposition=-15% underlinewidth=0.3";
my $baseboldmidfontoptions = $baseboldfontoptions . " fontsize=" . $fontsizemid;
my $baseboldmidfontoptions_u = $baseboldmidfontoptions . " underline=true underlineposition=-15% underlinewidth=0.3";
my $baseboldmidfontoptions_i = $baseboldmidfontoptions . " fontstyle=italic";
my $baselargefontoptions = $basefontoptions . " fontsize=" . $fontsizelarge;
my $baseboldlargefontoptions = $baseboldfontoptions . " fontsize=" . $fontsizelarge;
my $baseboldlargefontoptions_u = $baseboldlargefontoptions . " underline=true underlineposition=-15% underlinewidth=0.3";
my $baseboldlargefontoptions_ui = $baseboldlargefontoptions_u . " fontstyle=italic";
my $baseboldlargefontoptions_i = $baseboldlargefontoptions . " fontstyle=italic";
my $basesmallfontoptions = $basefontoptions . " fontsize=" . $fontsizesmall;
my $basesmallfontoptions_i = $basesmallfontoptions . " fontstyle=italic";
my $baseboldsmallfontoptions = $baseboldfontoptions . " fontsize=" . $fontsizesmall;
my $basemidlargefontoptions = $basefontoptions . " fontsize=" . $fontsizemidlarge;
my $basemidlargefontoptions_i = $basemidlargefontoptions . " fontstyle=italic";
my $basemidxlargefontoptions = $basefontoptions . " fontsize=" . $fontsizemidxlarge;
my $baseboldmidxlargefontoptions = $baseboldfontoptions . " fontsize=" . $fontsizemidxlarge;
my $basemidxlargefontoptions_i = $basemidxlargefontoptions . " fontstyle=italic";
my $baseboldmidlargefontoptions = $baseboldfontoptions . " fontsize=" . $fontsizemidlarge;
my $baseboldmidlargefontoptions_u = $baseboldmidlargefontoptions . " underline=true underlineposition=-15% underlinewidth=0.3";
my $baseboldxlargefontoptions = $baseboldfontoptions . " fontsize=" . $fontsizexlarge;
my $baseboldxlargefontoptions_i = $baseboldxlargefontoptions . " fontstyle=italic";
my $basecheckfontoptions = "fontname={DejaVuSans} encoding=unicode fontsize=10 charref";

my $marginleft = 30;
my $margintop = 35;
my $marginbottom = 30;
my $contentwidth = $pagewidth - 2 * $marginleft;
my $y_top = $pageheight - $margintop;
my $y_bottom = $marginbottom;

my $indoc;
my $no_of_input_pages;
my @pagehandles = ();
my $pagecount = 0;

my ($sec, $min, $hrs, $day, $month, $year, $wday, $julian) = localtime();
my $pdfpath = qq|$form->{'DOCROOT'}/forms/Print${table}${page}.pdf|;
#warn qq|pdfpath=${pdfpath}\n|;
my $formid = $hrs.$min;
my $filename = '/tmp/'.$form->{'LOGINID'}.'_'.DBUtil->genToken().'_'.DBUtil->Date('','stamp').'.pdf';
my $outfile = $form->{'file'} eq ''                # create and print pdf else just create.
        ? $form->{'DOCROOT'}.$filename
        : $form->{'file'};
#my $outfile = "kls.pdf";

############################################################################
# my $xdp = qq|<?xml version="1.0" encoding="UTF-8" ?> 
# <?xfa generator="XFA2_0" APIVersion="2.2.4333.0" ?>
# <xdp:xdp xmlns:xdp="http://ns.adobe.com/xdp/" >
# <xfa:datasets xmlns:xfa="http://www.xfa.org/schema/xfa-data/1.0/" >
# <xfa:data>
# <topmostSubform>
# |;
eval {

  # create a new PDFlib object 
  my $p = new PDFlib::PDFlib;

  $p->set_option("SearchPath={{" . $searchpath . "}}");

  # This mean we don't have to check error return values, but will
  # get an exception in case of runtime problems.
  
  $p->set_option("errorpolicy=exception");

  # all strings are expected as utf8
  $p->set_option("stringformat=utf8");

  $p->begin_document($outfile, "");

  $p->set_info("Creator", "Millennium Information Services");
  $p->set_info("Author", "Keith Stephenson");
  $p->set_info("Title", "PHQ");

  # Open the Block template which contains PDFlib Blocks 
  $indoc = $p->open_pdi_document($pdfpath, "");
  if ($indoc == -1) { die("Error: " . $p->get_errmsg()); }

  $no_of_input_pages = $p->pcos_get_number($indoc, "length:pages");

  main->openPdiPages($p);

  main->printPHQ($p);

  main->closePdiPages($p);

  $p->end_document("");

};

if ($@) {
  die("$0: PDFlib Exception occurred:\n$@");
}

$sPHQ->finish();
$sClient->finish();
$sProvider->finish();
$sxTables->finish();

myDBI->cleanup();

if ( $form->{'file'} eq '' )                # create and print pdf.
{ print qq|Location: ${filename}\n\n|; }

exit;

############################################################################
sub printPHQ {
  my ($self, $p) = @_;
  
  foreach my $ID ( split(' ',$form->{IDs}) )
  { 
  #warn "PrintPHQ: table=${table}, page=${page}, ID=${ID}\n";
    $sPHQ->execute($ID) || myDBI->dberror("PrintPHQ: select ${table} ${ID}");
    while ( my $rPHQ = $sPHQ->fetchrow_hashref )
    { 
      $sClient->execute($rPHQ->{'ClientID'}) || myDBI->dberror("select Client: $rPHQ->{'ClientID'}");
      my $rClient = $sClient->fetchrow_hashref;
      main->createPages($p, $rPHQ, $rClient); 
    }
  }

  if ($pagecount eq 0) {
    main->createEmptyPage($p);
  }
}

sub createEmptyPage {
  my ($self, $p) = @_;

  $p->begin_page_ext($pagewidth, $pageheight, "topdown");
  $p->fit_textline("NOT FOUND", $marginleft, 50, $basefontoptions);
  $p->end_page_ext("");
}

sub createPages
{
  my ($self, $p, $rPHQ, $rClient) = @_;
##
# Header info...GO AHEAD AND SET THESE BUT DON'T PUT THEM ON THE FORM FOR NOW.
  my $AgencyID = MgrTree->getAgency($form,$rClient->{'clinicClinicID'});
  $sProvider->execute($AgencyID) || myDBI->dberror("printPHQ: select Provider $AgencyID");
  my $rAgency = $sProvider->fetchrow_hashref;
  my $AgencyName = $rAgency->{Name};
  my $AgencyAddr = $rAgency->{Addr1} . ', ';
  $AgencyAddr .= $rAgency->{Addr2} . ', ' if ( $rAgency->{Addr2} );
  $AgencyAddr .= $rAgency->{City} . ', ' . $rAgency->{ST} . '  ' . $rAgency->{Zip};
  my $AgencyPhFax = 'Office: ' . $rAgency->{WkPh} . '  Fax: ' . $rAgency->{Fax};
  my $reportInfo = '';                                 # right side of heading
  my $Title = '';
##
  $sProvider->execute($rClient->{'ProvID'}) || myDBI->dberror("printPHQ: select PrimaryProvider $rClient->{'ProvID'}");
  my $rPrimaryProvider = $sProvider->fetchrow_hashref;
  my $primaryprovider = qq|$rPrimaryProvider->{'FName'} $rPrimaryProvider->{'LName'}|;
##
  $sProvider->execute($rPHQ->{'ProvID'}) || myDBI->dberror("printPHQ: select Clinician $rPHQ->{'ProvID'}");
  my $rClinician = $sProvider->fetchrow_hashref;
  my $clinician = qq|$rClinician->{'FName'} $rClinician->{'LName'}|;
##
  my $today = DBUtil->Date($form->{TODAY},'fmt','MM/DD/YYYY');
  my $testdate = DBUtil->Date($rPHQ->{TestDate},'fmt','MM/DD/YYYY');
  my $testdateMDY = DBUtil->Date($rPHQ->{TestDate},'fmt','MMDDYY');
##
  my $clientid = $rClient->{'ClientID'};
  my $clientname = qq|$rClient->{'FName'} $rClient->{'LName'}|;
  my $clientnameid = qq|$rClient->{'FName'} $rClient->{'LName'} / ${clientid}|;
  my $addr1 = $rClient->{'Addr1'};
  my $addr2 = $rClient->{'Addr2'};
  my $csz = qq|$rClient->{'City'}, $rClient->{'ST'}  $rClient->{'Zip'}|;
  if ( $addr2 eq '' ) { $addr2 = $csz; $csz = ''; }
  my $sex = $rClient->{'Gend'};
  my $age = DBUtil->Date($rClient->{'DOB'},'age');
##
  my %DBData = ();
  my $tALL = 0;
  my ($total,$t1,$t2,$t3) = (0,0,0,0);         # total = all t1=total all 1's, t2=total all 2's, t3=total all 3's values
  my ($t15,$t15_1,$t15_2) = (0,0,0);           # ClientPHQSADS [qA]
  my ($t7,$t7_1,$t7_2,$t7_3) = (0,0,0,0);      # ClientPHQSADS [qB]
  my ($t9,$t9_1,$t9_2,$t9_3) = (0,0,0,0);      # ClientPHQSADS [qD] & ClientPHQ9 [q10]
  my ($tINT,$tWM,$tD1,$tD2,$tD3,$tD4,$tD5,$tD6) = (0,0,0,0,0,0,0,0);              # ClientODAS,2017
  my ($tL1,$tL2,$tL3,$tL4,$tL5,$tL6) = (0,0,0,0,0,0);                             # ClientODAS,2017
  my ($sLINT,$tLWM,$tLD1,$tLD2,$tLD3,$tLD4,$tLD5,$tLD6) = (0,0,0,0,0,0,0,0);      # ClientODAS,2017
  my ($sIndicated,$sWMIndicated) = (0,0);                                         # ClientODAS,2017
  foreach my $f ( sort keys %{$rPHQ} )
  {
    $sxTables->execute($table,$f) || myDBI->dberror("printPHQ: select xTables ${table}/${f}");
    my $rxTables = $sxTables->fetchrow_hashref;
#foreach my $m ( sort keys %{$rxTables} ) { warn "${f}: rxTables-$m=$rxTables->{$m}\n"; }
    my $val = $rPHQ->{$f};
    $DBData{${f}} = ${val};
#   for check marks we get a range: 0-n; where the field Name: t(field)_n
#warn qq|${f}: theType=$rxTables->{'theType'}\n|;
    if ( $rxTables->{'theType'} =~ /radio/ )                # set check mark values
    {
      $DBData{"${f}_${val}"} = ${val};
      $t1 += 1 if ( $val == 1 );
      $t2 += 2 if ( $val == 2 );
      $t3 += 3 if ( $val == 3 );
      if ( $table eq 'ClientPHQSADS' && substr($f,0,2) eq 'qA' )
      {
        $t15_1 += 1 if ( $val == 1 );
        $t15_2 += 2 if ( $val == 2 );
      }
      elsif ( $table eq 'ClientPHQSADS' && substr($f,0,2) eq 'qB' )
      {
        $t7_1 += 1 if ( $val == 1 );
        $t7_2 += 2 if ( $val == 2 );
        $t7_3 += 3 if ( $val == 3 );
      }
      elsif ( $table eq 'ClientPHQSADS' && substr($f,0,2) eq 'qD' )
      {
        $t9_1 += 1 if ( $val == 1 );
        $t9_2 += 2 if ( $val == 2 );
        $t9_3 += 3 if ( $val == 3 );
      }
      elsif ( $table eq 'ClientPHQ9' && substr($f,0,3) ne 'q10' )
      {
        $t9_1 += 1 if ( $val == 1 );
        $t9_2 += 2 if ( $val == 2 );
        $t9_3 += 3 if ( $val == 3 );
      }
      elsif ( $table eq 'ClientPCL5' )
      {
        $DBData{"${f}_N"} = ${val};
      }
      $tALL += $val;           # total all 'radio' values (could add for 'selectlist' if a digit?)
#     END radio IF
    }
    if ( $table eq 'ClientTCUDS' && $f eq 'q12b' )      # Other specify check mark
    { 
      if ($val eq '') {
        $DBData{"${f}_0"} = 0;
      } else {
        $DBData{"${f}_1"} = 1;
      }
    }
    elsif ( $table eq 'ClientODAS' )
    {
      # Other specify check mark
      if ( $f eq 'D4Primary' || $f eq 'D4Secondary' || $f eq 'D4Tertiary' )
      {
        $DBData{"${f}_${val}"} = ${val};
      }
      # totals...
      $tINT += $val if ( $f eq 'D1q1' || $f eq 'D1q2' );
      $tWM += $val if ( $f eq 'D1q3' || $f eq 'D1q4' || $f eq 'D1q5' || $f eq 'D1q6' );
      $tD1 = $tINT + $tWM;
#warn qq|f=$f: val=$val:\n tINT=$tINT, tWM=$tWM, tD1=$tD1\n|;
      $tD2 += $val if ( substr($f,0,3) eq 'D2q' && $f ne 'D2q8' );
      $tD3 += $val if ( substr($f,0,3) eq 'D3q' && $f ne 'D3q9' );
      $tD4 += $val if ( substr($f,0,3) eq 'D4q' );
      $tD5 += $val if ( substr($f,0,3) eq 'D5q' );
      $tD6 += $val if ( substr($f,0,3) eq 'D6q' );
#warn qq|f=$f: val=$val:\n tD1=$tD1, tD2=$tD2, tD3=$tD3\n tD4=$tD4, tD5=$tD5, tD6=$tD6\n|;
    }
    elsif ( $table eq 'ClientODAS2017' )
    {
      # Other specify check mark
      if ( $f eq 'D4Primary' || $f eq 'D4Secondary' || $f eq 'D4Tertiary' )
      {
        $DBData{"${f}_${val}"} = ${val};
      }
      # totals...
      $tINT += $val if ( $f eq 'D1q1' || $f eq 'D1q2' );
      $tWM += $val if ( $f eq 'D1q3' || $f eq 'D1q4' || $f eq 'D1q5' || $f eq 'D1q6' || $f eq 'D1q7' );
      $tD1 = $tINT + $tWM;
#warn qq|f=$f: val=$val:\n tINT=$tINT, tWM=$tWM, tD1=$tD1\n|;
      $tD2 += $val if ( substr($f,0,3) eq 'D2q' );
      $tD3 += $val if ( substr($f,0,3) eq 'D3q' );
      $tD4 += $val if ( substr($f,0,3) eq 'D4q' );
      $tD5 += $val if ( substr($f,0,3) eq 'D5q' );
      $tD6 += $val if ( substr($f,0,3) eq 'D6q' );
#warn qq|f=$f: val=$val:\n tD1=$tD1, tD2=$tD2, tD3=$tD3\n tD4=$tD4, tD5=$tD5, tD6=$tD6\n|;
    }
  }
# Totals...
  $DBData{"tALL"} = ${tALL};
  $total = $t1 + $t2 + $t3; 
  $DBData{"t1"} = ${t1};
  $DBData{"t2"} = ${t2};
  $DBData{"t3"} = ${t3};
  $DBData{"total"} = ${total};
  if ( $table eq 'ClientPHQSADS' )
  {
    my $t15 = $t15_1 + $t15_2;
    $DBData{"t15_1"} = ${t15_1};
    $DBData{"t15_2"} = ${t15_2};
    $DBData{"t15"} = ${t15};
    my $t7 = $t7_1 + $t7_2 + $t7_3;
    $DBData{"t7_1"} = ${t7_1};
    $DBData{"t7_2"} = ${t7_2};
    $DBData{"t7_3"} = ${t7_3};
    $DBData{"t7"} = ${t7};
    my $t9 = $t9_1 + $t9_2 + $t9_3;
    $DBData{"t9_1"} = ${t9_1};
    $DBData{"t9_2"} = ${t9_2};
    $DBData{"t9_3"} = ${t9_3};
    $DBData{"t9"} = ${t9};
  }
  elsif ( $table eq 'ClientPHQ9' )
  {
    my $t9 = $t9_1 + $t9_2 + $t9_3;
    $DBData{"t9_1"} = ${t9_1};
    $DBData{"t9_2"} = ${t9_2};
    $DBData{"t9_3"} = ${t9_3};
    $DBData{"t9"} = ${t9};
  }
  elsif ( $table eq 'ClientPCL5' )
  {
    my $tB = $rPHQ->{'q1'} + $rPHQ->{'q2'} + $rPHQ->{'q3'} + $rPHQ->{'q4'} + $rPHQ->{'q5'};
    my $tC = $rPHQ->{'q6'} + $rPHQ->{'q7'};
    my $tD = $rPHQ->{'q8'} + $rPHQ->{'q9'} + $rPHQ->{'q10'} + $rPHQ->{'q11'} + $rPHQ->{'q12'} + $rPHQ->{'q13'} + $rPHQ->{'q14'};
    my $tE = $rPHQ->{'q15'} + $rPHQ->{'q16'} + $rPHQ->{'q17'} + $rPHQ->{'q18'} + $rPHQ->{'q19'} + $rPHQ->{'q20'};
    $DBData{"tB"} = ${tB};
    $DBData{"tC"} = ${tC};
    $DBData{"tD"} = ${tD};
    $DBData{"tE"} = ${tE};
    my $tBE = $tB + $tC + $tD + $tE;
    $DBData{"tBE"} = ${tBE};
  }
  elsif ( $table eq 'ClientCATS' )
  {
# set Caregiver Total PTSD Severity Score:
    $DBData{'tCPTSD'} = $rPHQ->{'qCB1'} + $rPHQ->{'qCB2'} + $rPHQ->{'qCB3'} + $rPHQ->{'qCB4'} + $rPHQ->{'qCB5'}
                      + $rPHQ->{'qCB6'} + $rPHQ->{'qCB7'} + $rPHQ->{'qCB8'} + $rPHQ->{'qCB9'} + $rPHQ->{'qCB10'}
                      + $rPHQ->{'qCB11'} + $rPHQ->{'qCB12'} + $rPHQ->{'qCB13'} + $rPHQ->{'qCB14'} + $rPHQ->{'qCB15'}
                      + $rPHQ->{'qCB16'} + $rPHQ->{'qCB17'} + $rPHQ->{'qCB18'} + $rPHQ->{'qCB19'} + $rPHQ->{'qCB20'};
# now set all the Caregiver Symptoms boxes...
    $DBData{'tC1thru5'} = 0;
    $DBData{'tC1thru5'}++ if ( $rPHQ->{'CqB1'} >= 2 );
    $DBData{'tC1thru5'}++ if ( $rPHQ->{'CqB2'} >= 2 );
    $DBData{'tC1thru5'}++ if ( $rPHQ->{'CqB3'} >= 2 );
    $DBData{'tC1thru5'}++ if ( $rPHQ->{'CqB4'} >= 2 );
    $DBData{'tC1thru5'}++ if ( $rPHQ->{'CqB5'} >= 2 );
    $DBData{'tC1thru5Flag'} = 1 if ( $DBData{'tC1thru5'} >= 1 );
    $DBData{'tC6thru7'} = 0;
    $DBData{'tC6thru7'}++ if ( $rPHQ->{'CqB6'} >= 2 );
    $DBData{'tC6thru7'}++ if ( $rPHQ->{'CqB7'} >= 2 );
    $DBData{'tC6thru7Flag'} = 1 if ( $DBData{'tC6thru7'} >= 1 );
    $DBData{'tC8thru14'} = 0;
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB8'} >= 2 );
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB9'} >= 2 );
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB10'} >= 2 );
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB11'} >= 2 );
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB12'} >= 2 );
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB13'} >= 2 );
    $DBData{'tC8thru14'}++ if ( $rPHQ->{'CqB14'} >= 2 );
    $DBData{'tC8thru14Flag'} = 1 if ( $DBData{'tC8thru14'} >= 2 );
    $DBData{'tC15thru20'} = 0;
    $DBData{'tC15thru20'}++ if ( $rPHQ->{'CqB15'} >= 2 );
    $DBData{'tC15thru20'}++ if ( $rPHQ->{'CqB16'} >= 2 );
    $DBData{'tC15thru20'}++ if ( $rPHQ->{'CqB17'} >= 2 );
    $DBData{'tC15thru20'}++ if ( $rPHQ->{'CqB18'} >= 2 );
    $DBData{'tC15thru20'}++ if ( $rPHQ->{'CqB19'} >= 2 );
    $DBData{'tC15thru20'}++ if ( $rPHQ->{'CqB20'} >= 2 );
    $DBData{'tC15thru20Flag'} = 1 if ( $DBData{'tC15thru20'} >= 2 );
    $DBData{'tCFI'} = 0;
    $DBData{'tCFI'}++ if ( $rPHQ->{'CqC1'} == 1 );
    $DBData{'tCFI'}++ if ( $rPHQ->{'CqC2'} == 1 );
    $DBData{'tCFI'}++ if ( $rPHQ->{'CqC3'} == 1 );
    $DBData{'tCFI'}++ if ( $rPHQ->{'CqC4'} == 1 );
    $DBData{'tCFI'}++ if ( $rPHQ->{'CqC5'} == 1 );
    $DBData{'tCFIFlag'} = 1 if ( $DBData{'tCFI'} >= 1 );

# set Child Total PTSD Severity Score:
    $DBData{'tPTSD'} = $rPHQ->{'qB1'} + $rPHQ->{'qB2'} + $rPHQ->{'qB3'} + $rPHQ->{'qB4'} + $rPHQ->{'qB5'}
                     + $rPHQ->{'qB6'} + $rPHQ->{'qB7'} + $rPHQ->{'qB8'} + $rPHQ->{'qB9'} + $rPHQ->{'qB10'}
                     + $rPHQ->{'qB11'} + $rPHQ->{'qB12'} + $rPHQ->{'qB13'} + $rPHQ->{'qB14'} + $rPHQ->{'qB15'}
                     + $rPHQ->{'qB16'} + $rPHQ->{'qB17'} + $rPHQ->{'qB18'} + $rPHQ->{'qB19'} + $rPHQ->{'qB20'};
# now set all the Child Symptoms boxes...
    $DBData{'t1thru5'} = 0;
    $DBData{'t1thru5'}++ if ( $rPHQ->{'qB1'} >= 2 );
    $DBData{'t1thru5'}++ if ( $rPHQ->{'qB2'} >= 2 );
    $DBData{'t1thru5'}++ if ( $rPHQ->{'qB3'} >= 2 );
    $DBData{'t1thru5'}++ if ( $rPHQ->{'qB4'} >= 2 );
    $DBData{'t1thru5'}++ if ( $rPHQ->{'qB5'} >= 2 );
    $DBData{'t1thru5Flag'} = 1 if ( $DBData{'t1thru5'} >= 1 );
    $DBData{'t6thru7'} = 0;
    $DBData{'t6thru7'}++ if ( $rPHQ->{'qB6'} >= 2 );
    $DBData{'t6thru7'}++ if ( $rPHQ->{'qB7'} >= 2 );
    $DBData{'t6thru7Flag'} = 1 if ( $DBData{'t6thru7'} >= 1 );
    $DBData{'t8thru14'} = 0;
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB8'} >= 2 );
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB9'} >= 2 );
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB10'} >= 2 );
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB11'} >= 2 );
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB12'} >= 2 );
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB13'} >= 2 );
    $DBData{'t8thru14'}++ if ( $rPHQ->{'qB14'} >= 2 );
    $DBData{'t8thru14Flag'} = 1 if ( $DBData{'t8thru14'} >= 2 );
    $DBData{'t15thru20'} = 0;
    $DBData{'t15thru20'}++ if ( $rPHQ->{'qB15'} >= 2 );
    $DBData{'t15thru20'}++ if ( $rPHQ->{'qB16'} >= 2 );
    $DBData{'t15thru20'}++ if ( $rPHQ->{'qB17'} >= 2 );
    $DBData{'t15thru20'}++ if ( $rPHQ->{'qB18'} >= 2 );
    $DBData{'t15thru20'}++ if ( $rPHQ->{'qB19'} >= 2 );
    $DBData{'t15thru20'}++ if ( $rPHQ->{'qB20'} >= 2 );
    $DBData{'t15thru20Flag'} = 1 if ( $DBData{'t15thru20'} >= 2 );
    $DBData{'tFI'} = 0;
    $DBData{'tFI'}++ if ( $rPHQ->{'qC1'} == 1 );
    $DBData{'tFI'}++ if ( $rPHQ->{'qC2'} == 1 );
    $DBData{'tFI'}++ if ( $rPHQ->{'qC3'} == 1 );
    $DBData{'tFI'}++ if ( $rPHQ->{'qC4'} == 1 );
    $DBData{'tFI'}++ if ( $rPHQ->{'qC5'} == 1 );
    $DBData{'tFIFlag'} = 1 if ( $DBData{'tFI'} >= 1 );
  }
  elsif ( $table eq 'ClientODAS' || $table eq 'ClientODAS2017' )
  {
    $DBData{"tINT"} = ${tINT};
    $DBData{"tWM"} = ${tWM};
    $DBData{"tD1"} = ${tD1};
    $DBData{"tD2"} = ${tD2};
    $DBData{"tD3"} = ${tD3};
    $DBData{"tD4"} = ${tD4};
    $DBData{"tD5"} = ${tD5};
    $DBData{"tD6"} = ${tD6};
# calculate the Service Levels ...
    my $tLINT = $tINT == 0 ? 0 : $tINT <= 2 ? 1 : $tINT <= 4 ? 2 : $tINT <= 6 ? 3 : 4;
    $tLWM = $tWM == 0 ? 0 : $tWM <= 4 ? 1 : $tWM <= 8 ? 1 : $tWM <= 12 ? 3 : 4;
    $tL1 = $tLINT;      # same as L1 ACUTE INTOXICATION
    $tL2 = $tD2 == 0 ? 0 : $tD2 <= 7 ? 1 : $tD2 <= 14 ? 2 : $tD2 <= 21 ? 3 : 4;
    $tL3 = $tD3 == 0 ? 0 : $tD3 <= 8 ? 1 : $tD3 <= 16 ? 2 : $tD3 <= 24 ? 3 : 4;
    $tL4 = $tD4 == 0 ? 0 : $tD4 <= 6 ? 1 : $tD4 <= 12 ? 2 : $tD4 <= 18 ? 3 : 4;
    $tL5 = $tD5 == 0 ? 0 : $tD5 <= 10 ? 1 : $tD5 <= 20 ? 2 : $tD5 <= 30 ? 3 : 4;
    $tL6 = $tD6 == 0 ? 0 : $tD6 <= 9 ? 1 : $tD6 <= 18 ? 2 : $tD6 <= 27 ? 3 : 4;
    $DBData{"tLINT"} = ${tLINT};
    $DBData{"tLWM"} = ${tLWM};
    $DBData{"tL1"} = ${tL1};
    $DBData{"tL2"} = ${tL2};
    $DBData{"tL3"} = ${tL3};
    $DBData{"tL4"} = ${tL4};
    $DBData{"tL5"} = ${tL5};
    $DBData{"tL6"} = ${tL6};
# and calculate the Indicated Service Level ...
    $sIndicated = $tL1 == 0 
                  && ($tL2 >= 0 && $tL2 <= 1) || ($tL2 >= 2 && $tL2 <= 3 && $rPHQ->{'D2q8'} == 1)
                  && ($tL3 >= 0 && $tL3 <= 1)
                  && ($tL5 >= 2 && $tL5 <= 4)
                  && ($tL6 >= 2 && $tL6 <= 3)
                  && ($tL4 >= 3 && $tL4 <= 3) ? '0.5'
                : ($tL1 >= 0 && $tL1 <= 1) || ($tL1 >= 2 && $tL1 <= 4 && $tWM == 1)
                  && ($tL2 >= 0 && $tL2 <= 1) || ($tL2 >= 2 && $tL2 <= 3 && $rPHQ->{'D2q8'} == 1)
                  && ($tL3 >= 0 && $tL3 <= 1) || ($tL3 >= 2 && $tL3 <= 3 && $rPHQ->{'D3q9'} == 1)
                  && ($tL5 >= 0 && $tL5 <= 2)
                  && ($tL6 >= 0 && $tL6 <= 2)
                  && ($tL4 >= 0 && $tL4 <= 2) || 
                     ($tL4 >= 3 && $tL4 <= 4 && $tL1 >= 0 && $tL1 <= 1 && $tL2 >= 0 && $tL2 <= 1 && $tL3 >= 0 && $tL3 <= 1 && $tL5 >= 0 && $tL5 <= 1 && $tL6 >= 0 && $tL6 <= 1) ? '1'
                : ($tL1 >= 3 && $tL1 <= 4)
                  && ($tL2 >= 0 && $tL2 <= 1) || ($tL2 >= 2 && $tL2 <= 3 && $rPHQ->{'D2q8'} == 1)
                  && ($tL3 >= 0 && $tL3 <= 1) || ($tL3 >= 2 && $tL3 <= 3 && $rPHQ->{'D3q9'} == 1)
                  && ($tL5 >= 2 && $tL5 <= 4)
                  && ($tL6 >= 0 && $tL6 <= 2)
                  && ($tL4 >= 0 && $tL4 <= 2) ? 'OTP1'
                : ($tL1 >= 0 && $tL1 <= 1) || ($tL1 >= 2 && $tL1 <= 4 && $tWM == 1)
                  && ($tL2 >= 0 && $tL2 <= 1) || ($tL2 >= 2 && $tL2 <= 3 && $rPHQ->{'D2q8'} == 1)
                  && ($tL3 >= 0 && $tL3 <= 2)
                  && ($tL5 >= 2 && $tL5 <= 3)
                  && ($tL6 >= 2 && $tL6 <= 3)
                  && ($tL4 >= 2 && $tL4 <= 3) ? '2.1'
                : ($tL1 >= 0 && $tL1 <= 1) || ($tL1 >= 2 && $tL1 <= 4 && $tWM == 1)
                  && ($tL2 >= 0 && $tL2 <= 1) || ($tL2 >= 2 && $tL2 <= 3 && $rPHQ->{'D2q8'} == 1)
                  && ($tL3 >= 0 && $tL3 <= 1) || ($tL3 >= 2 && $tL3 <= 3 && $rPHQ->{'D3q9'} == 1)
                  && ($tL5 >= 1 && $tL5 <= 3)
                  && ($tL6 >= 3 && $tL6 <= 4)
                  && ($tL4 >= 0 && $tL4 <= 3) ? '3.1'
                : ($tL1 >= 0 && $tL1 <= 1) || ($tL1 >= 2 && $tL1 <= 4 && $tWM == 1)
                  && ($tL2 >= 0 && $tL2 <= 1) || ($tL2 >= 2 && $tL2 <= 3 && $rPHQ->{'D2q8'} == 1)
                  && ($tL3 >= 3 && $tL3 <= 4) || (($tL3 >= 1 && $tL3 <= 2) && ($tL4 >= 3 && $tL4 <= 4))
                  && ($tL5 >= 3 && $tL5 <= 4)
                  && ($tL6 >= 3 && $tL6 <= 4)
                  && ($tL4 >= 3 && $tL4 <= 4) || (($tL4 >= 1 && $tL4 <= 2) && ($tL3 >= 3 && $tL3 <= 4)) ? '3.5'
                : '';
    $sWMIndicated = $tLWM == 2 ? '1 WM'
                  : $tLWM == 3 ? '3.2 WM'
                  : $tLWM == 4 ? '3.7 WM'
                  : 'none';
    $DBData{"sIndicated"} = ${sIndicated};
    $DBData{"sWMIndicated"} = ${sWMIndicated};
  }
# no logo on these forms...
#| . DBA->getLogo($form,'Client',$rClient->{ClientID},'base64') . qq|
# no Agency/companyname on these forms...
# reportInfo->testdate not on all forms, some only today's date
  
  $DBData{"reportInfo"} = $reportInfo;
  $DBData{"footerLeft"} = $clientnameid;
  # $DBData{"footerRight"} = $DT;
  $DBData{"agencyname"} = $AgencyName;
  $DBData{"agencyaddr"} = $AgencyAddr;
  $DBData{"agencyphonefax"} = $AgencyPhFax;
  $DBData{"primaryprovider"} = $primaryprovider;
  $DBData{"clinician"} = $clinician;
  $DBData{"testdate"} = $testdate;
  $DBData{"testdate_pg2"} = $testdate;
  $DBData{"testdate_pg3"} = $testdate;
  $DBData{"testdateMDY"} = $testdateMDY;
  $DBData{"today"} = $today;
  $DBData{"clientid"} = $clientid;
  $DBData{"clientname"} = $clientname;
  $DBData{"addr1"} = $addr1;
  $DBData{"addr2"} = $addr2;
  $DBData{"csz"} = $csz;
  $DBData{"sex"} = $sex;
  $DBData{"sex_F"} = $sex;
  $DBData{"sex_M"} = $sex;
  $DBData{"age"} = $age;

#  foreach my $f ( sort keys %DBData ) {
#    print("$f => " . $DBData{"$f"} . "\n");
#  }

#####################
  my @PageData = ();

  if ("$table$page" eq "ClientPHQSADS") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 627.6, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA1"} },             # qA1
          { "type" => "check", "ypos" => 611.3, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA2"} },             # qA2
          { "type" => "check", "ypos" => 594.7, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA3"} },             # qA3
          { "type" => "check", "ypos" => 578.2, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA4"} },             # qA4
          { "type" => "check", "ypos" => 561.8, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA5"} },             # qA5
          { "type" => "check", "ypos" => 529.7, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA6"} },             # qA6
          { "type" => "check", "ypos" => 501.8, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA7"} },             # qA7
          { "type" => "check", "ypos" => 485, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA8"} },             # qA8
          { "type" => "check", "ypos" => 468.7, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA9"} },             # qA9
          { "type" => "check", "ypos" => 452.4, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA10"} },             # qA10
          { "type" => "check", "ypos" => 435.8, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA11"} },             # qA11
          { "type" => "check", "ypos" => 419.3, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA12"} },             # qA12
          { "type" => "check", "ypos" => 402.7, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA13"} },             # qA13
          { "type" => "check", "ypos" => 386.4, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA14"} },             # qA14
          { "type" => "check", "ypos" => 369.8, "optlist" => "fontsize=11", "xposarray" => [385, 447, 509],
                                "val" => $DBData{"qA15"} },             # qA15
          { "type" => "textline", "ypos" => 337.2, "xpos" => 372, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t15"} },                       # t15
          { "type" => "textline", "ypos" => 337.2, "xpos" => 453.1, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t15_1"} },                       # t15_1
          { "type" => "textline", "ypos" => 337.2, "xpos" => 514.8, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t15_2"} },                       # t15_2
          { "type" => "check", "ypos" => 244.8, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "xpos" => $DBData{"qB1"} },             # qB1
          { "type" => "check", "ypos" => 227.3, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "val" => $DBData{"qB2"} },             # qB2
          { "type" => "check", "ypos" => 210, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "val" => $DBData{"qB3"} },             # qB3
          { "type" => "check", "ypos" => 192.5, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "val" => $DBData{"qB4"} },             # qB4
          { "type" => "check", "ypos" => 175, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "val" => $DBData{"qB5"} },             # qB5
          { "type" => "check", "ypos" => 157.2, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "val" => $DBData{"qB6"} },             # qB6
          { "type" => "check", "ypos" => 139.9, "optlist" => "fontsize=11", "xposarray" => [385, 428.5, 472, 515.5],
                                "val" => $DBData{"qB7"} },             # qB7
          { "type" => "textline", "ypos" => 105.6, "xpos" => 372, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t7"} },                       # t7
          { "type" => "textline", "ypos" => 105.6, "xpos" => 434.6, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t7_1"} },                       # t7_1
          { "type" => "textline", "ypos" => 105.6, "xpos" => 479.3, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t7_2"} },                       # t7_2
          { "type" => "textline", "ypos" => 105.6, "xpos" => 521.3, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t7_3"} },                       # t7_3
      ] },
      { "descr" => "page 2", "data" => [
          { "type" => "check", "ypos" => 701.5, "optlist" => "fontsize=11", "xposarray" => [435.6, 507.8],
                                "val" => $DBData{"qC1"} },             # qC1
          { "type" => "check", "ypos" => 681.6, "optlist" => "fontsize=11", "xposarray" => [435.6, 507.8],
                                "val" => $DBData{"qC2"} },             # qC2
          { "type" => "check", "ypos" => 641, "optlist" => "fontsize=11", "xposarray" => [435.6, 507.8],
                                "val" => $DBData{"qC3"} },             # qC3
          { "type" => "check", "ypos" => 611.3, "optlist" => "fontsize=11", "xposarray" => [435.6, 507.8],
                                "val" => $DBData{"qC4"} },             # qC4
          { "type" => "check", "ypos" => 582.2, "optlist" => "fontsize=11", "xposarray" => [435.6, 507.8],
                                "val" => $DBData{"qC5"} },             # qC5
          { "type" => "check", "ypos" => 495.1, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD1"} },             # qD1
          { "type" => "check", "ypos" => 466.3, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD2"} },             # qD2
          { "type" => "check", "ypos" => 425.8, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD3"} },             # qD3
          { "type" => "check", "ypos" => 397, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD4"} },             # qD4
          { "type" => "check", "ypos" => 379.2, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD5"} },             # qD5
          { "type" => "check", "ypos" => 350.2, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD6"} },             # qD6
          { "type" => "check", "ypos" => 309.4, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD7"} },             # qD7
          { "type" => "check", "ypos" => 246.7, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD8"} },             # qD8
          { "type" => "check", "ypos" => 205.7, "optlist" => "fontsize=11", "xposarray" => [384.7, 428.9, 472, 518.3],
                                "val" => $DBData{"qD9"} },             # qD9
          { "type" => "textline", "ypos" => 172, "xpos" => 372, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9"} },                       # t9
          { "type" => "textline", "ypos" => 172, "xpos" => 433.7, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9_1"} },                       # t9_1
          { "type" => "textline", "ypos" => 172, "xpos" => 478.3, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9_2"} },                       # t9_2
          { "type" => "textline", "ypos" => 172, "xpos" => 523.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9_3"} },                       # t9_3
          { "type" => "check", "ypos" => 91.4, "optlist" => "fontsize=11", "xposarray" => [159, 310.8, 425, 518.2],
                                "val" => $DBData{"qE"} },             # qE
      ] }
    );
  }
  elsif ("$table$page" eq "ClientPHQ") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textline", "ypos" => 640.1, "xpos" => 100,
                                "text" => $DBData{"clientname"} },                       # clientname
          { "type" => "textline", "ypos" => 640.1, "xpos" => 241,
                                "text" => $DBData{"age"} },                       # age
          { "type" => "textline", "ypos" => 638.8, "xpos" => 305, "optlist" => $basecheckfontoptions . " fontsize=11",
                                "text" => $DBData{"sex_F"} eq 'F' ? '&#x2713;' : '' },                       # Sex F
          { "type" => "textline", "ypos" => 638.8, "xpos" => 360, "optlist" => $basecheckfontoptions . " fontsize=11",
                                "text" => $DBData{"sex_M"} eq 'M' ? '&#x2713;' : '' },                       # Sex M
          { "type" => "textline", "ypos" => 640.1, "xpos" => 473,
                                "text" => $DBData{"testdate"} },                  # testdate
          { "type" => "check", "ypos" => 582, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1a"} },             # q1a
          { "type" => "check", "ypos" => 566.4, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1b"} },             # q1b
          { "type" => "check", "ypos" => 550.8, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1c"} },             # q1c
          { "type" => "check", "ypos" => 525.1, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1d"} },             # q1d
          { "type" => "check", "ypos" => 509.5, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1e"} },             # q1e
          { "type" => "check", "ypos" => 493.9, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1f"} },             # q1f
          { "type" => "check", "ypos" => 478.6, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1g"} },             # q1g
          { "type" => "check", "ypos" => 463, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1h"} },             # q1h
          { "type" => "check", "ypos" => 447.4, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1i"} },             # q1i
          { "type" => "check", "ypos" => 431.8, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1j"} },             # q1j
          { "type" => "check", "ypos" => 416.4, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1k"} },             # q1k
          { "type" => "check", "ypos" => 401, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1l"} },             # q1l
          { "type" => "check", "ypos" => 385.4, "optlist" => "fontsize=11", "xposarray" => [397, 453.4, 509.8],
                                "val" => $DBData{"q1m"} },             # q1m
          { "type" => "check", "ypos" => 323.3, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2a"} },             # q2a
          { "type" => "check", "ypos" => 307.9, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2b"} },             # q2b
          { "type" => "check", "ypos" => 282, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2c"} },             # q2c
          { "type" => "check", "ypos" => 266.9, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2d"} },             # q2d
          { "type" => "check", "ypos" => 251, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2e"} },             # q2e
          { "type" => "check", "ypos" => 225.1, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2f"} },             # q2f
          { "type" => "check", "ypos" => 199.2, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2g"} },             # q2g
          { "type" => "check", "ypos" => 162.5, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2h"} },             # q2h
          { "type" => "check", "ypos" => 136.8, "optlist" => "fontsize=11", "xposarray" => [389.8, 432.5, 474.5, 517],
                                "val" => $DBData{"q2i"} },             # q2i                                
      ] },
      { "descr" => "page 2", "data" => [
          { "type" => "check", "ypos" => 677.3, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q3a"} },             # q3a
          { "type" => "check", "ypos" => 646.6, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q3b"} },             # q3b
          { "type" => "check", "ypos" => 610.1, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q3c"} },             # q3c
          { "type" => "check", "ypos" => 583.9, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q3d"} },             # q3d
          { "type" => "check", "ypos" => 535.2, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4a"} },             # q4a
          { "type" => "check", "ypos" => 519.6, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4b"} },             # q4b
          { "type" => "check", "ypos" => 504.2, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4c"} },             # q4c
          { "type" => "check", "ypos" => 488.6, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4d"} },             # q4d
          { "type" => "check", "ypos" => 473, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4e"} },             # q4e
          { "type" => "check", "ypos" => 457.7, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4f"} },             # q4f
          { "type" => "check", "ypos" => 431.5, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4g"} },             # q4g
          { "type" => "check", "ypos" => 416.2, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4h"} },             # q4h
          { "type" => "check", "ypos" => 400.8, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4i"} },             # q4i
          { "type" => "check", "ypos" => 385.2, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4j"} },             # q4j
          { "type" => "check", "ypos" => 369.6, "optlist" => "fontsize=11", "xposarray" => [421.4, 499],
                                "val" => $DBData{"q4k"} },             # q4k
          { "type" => "check", "ypos" => 292.6, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5a"} },             # q5a
          { "type" => "check", "ypos" => 260.9, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5b"} },             # q5b
          { "type" => "check", "ypos" => 245.5, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5c"} },             # q5c
          { "type" => "check", "ypos" => 229.7, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5d"} },             # q5d
          { "type" => "check", "ypos" => 214.3, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5e"} },             # q5e
          { "type" => "check", "ypos" => 199, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5f"} },             # q5f
          { "type" => "check", "ypos" => 173, "optlist" => "fontsize=11", "xposarray" => [397.4, 453.4, 509.8],
                                "val" => $DBData{"q5g"} },             # q5g
      ] },
      { "descr" => "page 3", "data" => [
          { "type" => "check", "ypos" => 721.2, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q6a"} },             # q6a
          { "type" => "check", "ypos" => 683.3, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q6b"} },             # q6b
          { "type" => "check", "ypos" => 642.5, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q6c"} },             # q6c
          { "type" => "check", "ypos" => 583, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q7a"} },             # q7a
          { "type" => "check", "ypos" => 565.4, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q7b"} },             # q7b
          { "type" => "check", "ypos" => 541.2, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q7c"} },             # q7c
          { "type" => "check", "ypos" => 516, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q7d"} },             # q7d
          { "type" => "check", "ypos" => 473.8, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q8"} },             # q8
          { "type" => "check", "ypos" => 431.3, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q9"} },             # q9
          { "type" => "check", "ypos" => 372.7, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q10a"} },             # q10a
          { "type" => "check", "ypos" => 336, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q10b"} },             # q10b
          { "type" => "check", "ypos" => 309.6, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q10c"} },             # q10c
          { "type" => "check", "ypos" => 284.2, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q10d"} },             # q10d
          { "type" => "check", "ypos" => 258.7, "optlist" => "fontsize=11", "xposarray" => [435.1, 499],
                                "val" => $DBData{"q10e"} },             # q10e
          { "type" => "check", "ypos" => 170.9, "optlist" => "fontsize=11", "xposarray" => [124.3, 239, 351.1, 473.8],
                                "val" => $DBData{"q11"} },             # q11
      ] }
    );
  }
  elsif ("$table$page" eq "ClientPHQ15") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 584.6, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "check", "ypos" => 555.4, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "check", "ypos" => 526.3, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q3"} },             # q3
          { "type" => "check", "ypos" => 496.6, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q4"} },             # q4
          { "type" => "check", "ypos" => 467.8, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q5"} },             # q5
          { "type" => "check", "ypos" => 438.2, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q6"} },             # q6
          { "type" => "check", "ypos" => 409, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q7"} },             # q7
          { "type" => "check", "ypos" => 379.7, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q8"} },             # q8
          { "type" => "check", "ypos" => 350.4, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q9"} },             # q9
          { "type" => "check", "ypos" => 320.9, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q10"} },             # q10
          { "type" => "check", "ypos" => 291.8, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q11"} },             # q11
          { "type" => "check", "ypos" => 262.3, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q12"} },             # q12
          { "type" => "check", "ypos" => 233, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q13"} },             # q13
          { "type" => "check", "ypos" => 204, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q14"} },             # q14
          { "type" => "check", "ypos" => 174.5, "optlist" => "fontsize=11", "xposarray" => [396, 454.6, 513.6],
                                "val" => $DBData{"q15"} },             # q15
          { "type" => "textline", "ypos" => 134.6, "xpos" => 412.6, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"total"} },                       # total
          { "type" => "textline", "ypos" => 134.6, "xpos" => 462, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t1"} },                       # t1
          { "type" => "textline", "ypos" => 134.6, "xpos" => 516.7, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t2"} },                       # t2
      ] }
    );
  }
  elsif ("$table$page" eq "ClientPHQ9") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 609.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "check", "ypos" => 571, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "check", "ypos" => 532.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q3"} },             # q3
          { "type" => "check", "ypos" => 494.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q4"} },             # q4
          { "type" => "check", "ypos" => 456.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q5"} },             # q5
          { "type" => "check", "ypos" => 417.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q6"} },             # q6
          { "type" => "check", "ypos" => 379.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q7"} },             # q7
          { "type" => "check", "ypos" => 341, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q8"} },             # q8
          { "type" => "check", "ypos" => 302.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.6, 472.8, 517.4],
                                "val" => $DBData{"q9"} },             # q9
          { "type" => "textline", "ypos" => 258.7, "xpos" => 422.9, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9_1"} },                       # t9_1
          { "type" => "textline", "ypos" => 258.7, "xpos" => 470.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9_2"} },                       # t9_2
          { "type" => "textline", "ypos" => 258.7, "xpos" => 517.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9_3"} },                       # t9_3
          { "type" => "textline", "ypos" => 244.6, "xpos" => 517.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t9"} },                       # t9
          { "type" => "check", "ypos" => 145.4, "xposarray" => [141.4, 252.7, 366.2, 479.8],
                                "val" => $DBData{"q10"} },             # q10
      ] }
    );
  }
  elsif ("$table$page" eq "ClientGAD7") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 594.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "check", "ypos" => 559.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "check", "ypos" => 522.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q3"} },             # q3
          { "type" => "check", "ypos" => 487.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q4"} },             # q4
          { "type" => "check", "ypos" => 450.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q5"} },             # q5
          { "type" => "check", "ypos" => 415.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q6"} },             # q6
          { "type" => "check", "ypos" => 379.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [352.8, 405.4, 459, 513.4],
                                "val" => $DBData{"q7"} },             # q7
          { "type" => "textline", "ypos" => 334.1, "xpos" => 359.6, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"total"} },                       # total
          { "type" => "textline", "ypos" => 334.1, "xpos" => 405.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t1"} },                       # t1
          { "type" => "textline", "ypos" => 334.1, "xpos" => 459, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t2"} },                       # t2
          { "type" => "textline", "ypos" => 334.1, "xpos" => 513.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t3"} },                       # t3
      ] }
    );
  }
  elsif ("$table$page" eq "ClientPHQ4") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 587.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [351, 405.7, 459, 513],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "check", "ypos" => 548.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [351, 405.7, 459, 513],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "check", "ypos" => 510.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [351, 405.7, 459, 513],
                                "val" => $DBData{"q3"} },             # q3
          { "type" => "check", "ypos" => 472.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [351, 405.7, 459, 513],
                                "val" => $DBData{"q4"} },             # q4
          { "type" => "textline", "ypos" => 438.5, "xpos" => 351, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"total"} },                       # total
          { "type" => "textline", "ypos" => 438.5, "xpos" => 398.5, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t1"} },                       # t1
          { "type" => "textline", "ypos" => 438.5, "xpos" => 450, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t2"} },                       # t2
          { "type" => "textline", "ypos" => 438.5, "xpos" => 505.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"t3"} },                       # t3
      ] }
    );
  }
  elsif ("$table$page" eq "ClientPHQBrief") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textline", "ypos" => 667.1, "xpos" => 79.6,
                                "text" => $DBData{"clientname"} },                       # clientname
          { "type" => "textline", "ypos" => 667.1, "xpos" => 258.8,
                                "text" => $DBData{"age"} },                       # age
          { "type" => "textline", "ypos" => 667.1, "xpos" => 330.5, "optlist" => $basecheckfontoptions . " fontsize=11",
                                "text" => $DBData{"sex_F"} eq 'F' ? '&#x2713;' : '' },                       # Sex F
          { "type" => "textline", "ypos" => 667.1, "xpos" => 390.6, "optlist" => $basecheckfontoptions . " fontsize=11",
                                "text" => $DBData{"sex_M"} eq 'M' ? '&#x2713;' : '' },                       # Sex M
          { "type" => "textline", "ypos" => 667.1, "xpos" => 508,
                                "text" => $DBData{"testdate"} },                  # testdate
          { "type" => "check", "ypos" => 600.5, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1a"} },             # q1a
          { "type" => "check", "ypos" => 581.3, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1b"} },             # q1b
          { "type" => "check", "ypos" => 562.3, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1c"} },             # q1c
          { "type" => "check", "ypos" => 543.4, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1d"} },             # q1d
          { "type" => "check", "ypos" => 524.2, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1d"} },             # q1e
          { "type" => "check", "ypos" => 496.1, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1f"} },             # q1f
          { "type" => "check", "ypos" => 468.2, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1g"} },             # q1g
          { "type" => "check", "ypos" => 429.4, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1h"} },             # q1h
          { "type" => "check", "ypos" => 401.9, "xposarray" => [373.7, 421, 478.1, 535.2],
                                "val" => $DBData{"q1i"} },             # q1i
          { "type" => "check", "ypos" => 343.2, "xposarray" => [411.6, 468.7],
                                "val" => $DBData{"q2a"} },             # q2a
          { "type" => "check", "ypos" => 302.2, "xposarray" => [411.6, 468.7],
                                "val" => $DBData{"q2b"} },             # q2b
          { "type" => "check", "ypos" => 274.3, "xposarray" => [411.6, 468.7],
                                "val" => $DBData{"q2c"} },             # q2c
          { "type" => "check", "ypos" => 246.2, "xposarray" => [411.6, 468.7],
                                "val" => $DBData{"q2d"} },             # q2d
          { "type" => "check", "ypos" => 207.4, "xposarray" => [411.6, 468.7],
                                "val" => $DBData{"q2e"} },             # q2e
          { "type" => "check", "ypos" => 157.4, "xposarray" => [65.5, 207.4, 350.4, 470.6],
                                "val" => $DBData{"q3"} },             # q3
      ] },
      { "descr" => "page 2", "data" => [
          { "type" => "check", "ypos" => 717.4, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4a"} },             # q4a
          { "type" => "check", "ypos" => 698.2, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4b"} },             # q4b
          { "type" => "check", "ypos" => 679.2, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4c"} },             # q4c
          { "type" => "check", "ypos" => 660.2, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4d"} },             # q4d
          { "type" => "check", "ypos" => 641, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4e"} },             # q4e
          { "type" => "check", "ypos" => 621.8, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4f"} },             # q4f
          { "type" => "check", "ypos" => 602.6, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4g"} },             # q4g
          { "type" => "check", "ypos" => 583.7, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4h"} },             # q4h
          { "type" => "check", "ypos" => 564.5, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4i"} },             # q4i
          { "type" => "check", "ypos" => 545.5, "xposarray" => [415.2, 469, 529.2],
                                "val" => $DBData{"q4j"} },             # q4j
          { "type" => "check", "ypos" => 464.4, "xposarray" => [415.2, 469],
                                "val" => $DBData{"q5"} },             # q5
          { "type" => "textline", "ypos" => 446.2, "xpos" => 312, "optlist" => $basefontoptions,
                                "text" => $DBData{"q6"} },                       # q6
          { "type" => "check", "ypos" => 400.1, "xposarray" => [415.2, 469],
                                "val" => $DBData{"q7"} },             # q7
          { "type" => "check", "ypos" => 347.5, "xposarray" => [66.7, 150.2, 249.4, 363.6, 456.7],
                                "val" => $DBData{"q8a"} },             # q8a
          { "type" => "check", "ypos" => 237.6, "xposarray" => [400.1, 462.2],
                                "val" => $DBData{"q8b"} },             # q8b
          { "type" => "check", "ypos" => 215.8, "xposarray" => [400.1, 462.2],
                                "val" => $DBData{"q8c"} },             # q8d
          { "type" => "check", "ypos" => 196.6, "xposarray" => [400.1, 462.2],
                                "val" => $DBData{"q8d"} },             # q8d
          { "type" => "check", "ypos" => 177.6, "xposarray" => [400.1, 462.2],
                                "val" => $DBData{"q8e"} },             # q8e
          { "type" => "check", "ypos" => 158.4, "xposarray" => [400.1, 462.2],
                                "val" => $DBData{"q8f"} },             # q8f
      ] }
    );
  }
  elsif ("$table$page" eq "ClientTPHQ9") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 610.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "check", "ypos" => 580.3, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "check", "ypos" => 548.3, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q3"} },             # q3
          { "type" => "check", "ypos" => 519.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q4"} },             # q4
          { "type" => "check", "ypos" => 489.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q5"} },             # q5
          { "type" => "check", "ypos" => 453.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q6"} },             # q6
          { "type" => "check", "ypos" => 415.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q7"} },             # q7
          { "type" => "check", "ypos" => 364, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q8"} },             # q8
          { "type" => "check", "ypos" => 312.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.7],
                                "val" => $DBData{"q9"} },             # q9
          { "type" => "check", "ypos" => 272.5, "xposarray" => [138.2, 107.3],
                                "val" => $DBData{"q10"} },             # q10
          { "type" => "check", "ypos" => 195.1, "xposarray" => [141.5, 252.7, 366.1, 479.9],
                                "val" => $DBData{"q11"} },             # q11
          { "type" => "check", "ypos" => 159.5, "xposarray" => [138.2, 107.3],
                                "val" => $DBData{"q12"} },             # q12
          { "type" => "check", "ypos" => 121.3, "xposarray" => [138.2, 107.3],
                                "val" => $DBData{"q13"} },             # q13
          { "type" => "textline", "ypos" => 69.5, "xpos" => 306, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"total"} },                       # total
      ] }
    );
  }
  elsif ("$table$page" eq "ClientPHQ2") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 608.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.3],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "check", "ypos" => 570.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [382.3, 428.8, 473, 517.3],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "textline", "ypos" => 258.4, "xpos" => 423.4, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"total"} },                       # total
          { "type" => "textline", "ypos" => 258.4, "xpos" => 519.1, "optlist" => $basefontoptions . " position={center bottom}",
                                "text" => $DBData{"total"} },                       # total
      ] }
    );
  }
  elsif ("$table$page" eq "ClientODAS") {
    @PageData = (
      { "descr" => "page 1", "data" => [
      ] },
      { "descr" => "page 2", "data" => [
          { "type" => "textline", "ypos" => 604.8, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D1q1"} },                       # D1q1
          { "type" => "textflow", "ypos" => 595.5, "xpos_start" => 129.8, "xpos_end" => 447.6, "optlist" => "leading=170%",
                                "text" => $DBData{"TextD1q1"} },                       # TextD1q1
          { "type" => "textline", "ypos" => 472, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D1q2"} },                       # D1q2
          { "type" => "textflow", "ypos" => 472.3, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD1q2"} },                       # TextD1q2
          { "type" => "textline", "ypos" => 423.8, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tINT"} },                       # tINT
          { "type" => "textflow", "ypos" => 387.4, "xpos_start" => 129.8, "xpos_end" => 447.6, "optlist" => "leading=160%",
                                "text" => $DBData{"CommentsAI"} },                       # INT COMMENTS
          { "type" => "textline", "ypos" => 232.3, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D1q3"} },                       # D1q3
          { "type" => "textflow", "ypos" => 232.3, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD1q3"} },                       # TextD1q3
          { "type" => "textline", "ypos" => 110.6, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D1q4"} },                       # D1q4
          { "type" => "textflow", "ypos" => 110.6, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD1q4"} },                       # TextD1q4
      ] },
      { "descr" => "page 3", "data" => [
          { "type" => "textline", "ypos" => 662.4, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D1q5"} },                       # D1q5
          { "type" => "textflow", "ypos" => 662.4, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD1q5"} },                       # TextD1q5
          { "type" => "textline", "ypos" => 552.5, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D1q6"} },                       # D1q6
          { "type" => "textflow", "ypos" => 552.5, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD1q6"} },                       # TextD1q6
          { "type" => "textline", "ypos" => 504.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tWM"} },                       # tWM
          { "type" => "check", "ypos" => 468.5, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [505.9, 473.3],
                                "val" => $DBData{"D1q7"} },             # D1q7
          { "type" => "check", "ypos" => 443.8, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [505.9, 473.3],
                                "val" => $DBData{"D1q8"} },             # D1q8
          { "type" => "textflow", "ypos" => 410, "xpos_start" => 57.4, "xpos_end" => 553.7, "optlist" => "leading=170%",
                                "text" => $DBData{"CommentsWM"} },                       # WM COMMENTS
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [319, 307, 294.5, 282.5, 270.2],
                                "val" => main->getSeverityRating($DBData{"tINT"}, ([0, 0], [1, 2], [3, 4], [5, 6], [7, 8])) },             # DIMENSION 1 INT SCORING
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [194.6, 182.2, 170.2, 157.9, 145.7],
                                "val" => main->getSeverityRating($DBData{"tWM"}, ([0, 0], [1, 4], [5, 8], [9, 12], [13, 16])) },             # DIMENSION 1 WM SCORING
      ] },
      { "descr" => "page 4", "data" => [
          { "type" => "textline", "ypos" => 640.3, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q1"} },                       # D2q1
          { "type" => "textflow", "ypos" => 640.3, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q1"} },                       # TextD2q1
          { "type" => "textline", "ypos" => 511, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q2"} },                       # D2q2
          { "type" => "textflow", "ypos" => 511, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q2"} },                       # TextD2q2
          { "type" => "textline", "ypos" => 389, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q3"} },                       # D2q3
          { "type" => "textflow", "ypos" => 389, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q3"} },                       # TextD2q3
          { "type" => "textline", "ypos" => 279.1, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q4"} },                       # D2q4
          { "type" => "textflow", "ypos" => 279.1, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q4"} },                       # TextD2q4
          { "type" => "textline", "ypos" => 169.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q5"} },                       # D2q5
          { "type" => "textflow", "ypos" => 169.2, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q5"} },                       # TextD2q5
      ] },
      { "descr" => "page 5", "data" => [
          { "type" => "textline", "ypos" => 662.4, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q6"} },                       # D2q6
          { "type" => "textflow", "ypos" => 662.4, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q6"} },                       # TextD2q6
          { "type" => "textline", "ypos" => 555.1, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D2q7"} },                       # D2q7
          { "type" => "textflow", "ypos" => 555.1, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD2q7"} },                       # TextD2q7
          { "type" => "check", "ypos" => 492.7, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [505.9, 473.3],
                                "val" => $DBData{"D2q8"} },             # D2q8
          { "type" => "textline", "ypos" => 459.8, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tD2"} },                       # tD2
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [389.8, 377.8, 365.3, 353.3, 341],
                                "val" => main->getSeverityRating($DBData{"tD2"}, ([0, 0], [1, 7], [8, 14], [15, 21], [22, 28])) },             # DIMENSION 2 SCORING
          { "type" => "textflow", "ypos" => 314.2, "xpos_start" => 57.4, "xpos_end" => 553.7,
                                "text" => $DBData{"CommentsD2"} },                       # CommentsD2
          { "type" => "textline", "ypos" => 108.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q1"} },                       # D3q1
          { "type" => "textflow", "ypos" => 108.2, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q1"} },                       # TextD3q1
      ] },
      { "descr" => "page 6", "data" => [
          { "type" => "textline", "ypos" => 662.8, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q2"} },                       # D3q2
          { "type" => "textflow", "ypos" => 662.8, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q2"} },                       # TextD3q2
          { "type" => "textline", "ypos" => 541.4, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q3"} },                       # D3q3
          { "type" => "textflow", "ypos" => 541.4, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q3"} },                       # TextD3q3
          { "type" => "textline", "ypos" => 429.1, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q4"} },                       # D3q4
          { "type" => "textflow", "ypos" => 429.1, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q4"} },                       # TextD3q4
          { "type" => "textline", "ypos" => 319, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q5"} },                       # D3q5
          { "type" => "textflow", "ypos" => 319, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q5"} },                       # TextD3q5
          { "type" => "textline", "ypos" => 209.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q6"} },                       # D3q6
          { "type" => "textflow", "ypos" => 209.2, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q6"} },                       # TextD3q6
          { "type" => "textline", "ypos" => 87.1, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q7"} },                       # D3q7
          { "type" => "textflow", "ypos" => 87.1, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q7"} },                       # TextD3q7
      ] },
      { "descr" => "page 7", "data" => [
          { "type" => "textline", "ypos" => 638.6, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D3q8"} },                       # D3q8
          { "type" => "textflow", "ypos" => 638.6, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD3q8"} },                       # TextD3q8
          { "type" => "check", "ypos" => 575.3, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [505.9, 473.3],
                                "val" => $DBData{"D3q9"} },             # D3q9
          { "type" => "textline", "ypos" => 538.1, "xpos" => 468.7, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tD3"} },                       # tD3
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [458.6, 446, 433.8, 421.6, 409.3],
                                "val" => main->getSeverityRating($DBData{"tD3"}, ([0, 0], [1, 8], [9, 16], [17, 24], [25, 32])) },             # DIMENSION 3 SCORING
          { "type" => "textflow", "ypos" => 384.2, "xpos_start" => 57.4, "xpos_end" => 553.7,
                                "text" => $DBData{"CommentsD3"} },                       # CommentsD3
          { "type" => "textline", "ypos" => 169.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q1"} },                       # D5q1
          { "type" => "textflow", "ypos" => 168.2, "xpos_start" => 129.8, "xpos_end" => 447.6, "optlist" => "leading=170%",
                                "text" => $DBData{"TextD5q1"} },                       # TextD5q1
      ] },
      { "descr" => "page 8", "data" => [
          { "type" => "textline", "ypos" => 648, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q2"} },                       # D5q2
          { "type" => "textflow", "ypos" => 647, "xpos_start" => 129.8, "xpos_end" => 447.6, "optlist" => "leading=170%",
                                "text" => $DBData{"TextD5q2"} },                       # TextD5q2
          { "type" => "textline", "ypos" => 523.7, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q3"} },                       # D5q3
          { "type" => "textflow", "ypos" => 513.2, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q3"} },                       # TextD5q3
          { "type" => "textline", "ypos" => 391.4, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q4"} },                       # D5q4
          { "type" => "textflow", "ypos" => 381, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q4"} },                       # TextD5q4
          { "type" => "textline", "ypos" => 259.4, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q5"} },                       # D5q5
          { "type" => "textflow", "ypos" => 259.4, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q5"} },                       # TextD5q5
          { "type" => "textline", "ypos" => 125, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q6"} },                       # D5q6
          { "type" => "textflow", "ypos" => 125, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q6"} },                       # TextD5q6
      ] },
      { "descr" => "page 9", "data" => [
          { "type" => "textline", "ypos" => 647.8, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q7"} },                       # D5q7
          { "type" => "textflow", "ypos" => 647.8, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q7"} },                       # TextD5q7
          { "type" => "textline", "ypos" => 537.6, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q8"} },                       # D5q8
          { "type" => "textflow", "ypos" => 537.6, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q8"} },                       # TextD5q8
          { "type" => "textline", "ypos" => 428.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q9"} },                       # D5q9
          { "type" => "textflow", "ypos" => 418, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q9"} },                       # TextD5q9
          { "type" => "textline", "ypos" => 308.6, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D5q10"} },                       # D5q10
          { "type" => "textflow", "ypos" => 308.6, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD5q10"} },                       # TextD5q10
          { "type" => "textline", "ypos" => 257.3, "xpos" => 505.2, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tD5"} },                       # tD5
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [204.7, 192, 179.8, 167.5, 155.5],
                                "val" => main->getSeverityRating($DBData{"tD5"}, ([0, 0], [1, 10], [11, 20], [21, 30], [31, 40])) },             # DIMENSION 5 SCORING
          { "type" => "textflow", "ypos" => 143.5, "xpos_start" => 57.4, "xpos_end" => 553.7,
                                "text" => $DBData{"CommentsD5"} },                       # CommentsD5
      ] },
      { "descr" => "page 10", "data" => [
          { "type" => "textline", "ypos" => 616.1, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q1"} },                       # D6q1
          { "type" => "textflow", "ypos" => 616.1, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q1"} },                       # TextD6q1
          { "type" => "textline", "ypos" => 506.6, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q2"} },                       # D6q2
          { "type" => "textflow", "ypos" => 506.6, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q2"} },                       # TextD6q2
          { "type" => "textline", "ypos" => 397, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q3"} },                       # D6q3
          { "type" => "textflow", "ypos" => 397, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q3"} },                       # TextD6q3
          { "type" => "textline", "ypos" => 274.6, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q4"} },                       # D6q4
          { "type" => "textflow", "ypos" => 274.6, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q4"} },                       # TextD6q4
          { "type" => "textline", "ypos" => 140.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q5"} },                       # D6q5
          { "type" => "textflow", "ypos" => 140.2, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q5"} },                       # TextD6q5
      ] },
      { "descr" => "page 11", "data" => [
          { "type" => "textline", "ypos" => 672, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q6"} },                       # D6q6
          { "type" => "textflow", "ypos" => 672, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q6"} },                       # TextD6q6
          { "type" => "textline", "ypos" => 562.3, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q7"} },                       # D6q7
          { "type" => "textflow", "ypos" => 562.3, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q7"} },                       # TextD6q7
          { "type" => "textline", "ypos" => 453, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q8"} },                       # D6q8
          { "type" => "textflow", "ypos" => 453, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q8"} },                       # TextD6q8
          { "type" => "textline", "ypos" => 343.2, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D6q9"} },                       # D6q9
          { "type" => "textflow", "ypos" => 343.2, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD6q9"} },                       # TextD6q9
          { "type" => "textline", "ypos" => 291.6, "xpos" => 505.2, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tD6"} },                       # tD6
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [226.6, 214.1, 201.8, 189.6, 177.6],
                                "val" => main->getSeverityRating($DBData{"tD6"}, ([0, 0], [1, 9], [10, 18], [19, 27], [28, 36])) },             # DIMENSION 6 SCORING
          { "type" => "textflow", "ypos" => 164.9, "xpos_start" => 57.4, "xpos_end" => 553.7,
                                "text" => $DBData{"CommentsD6"} },                       # CommentsD6
      ] },
      { "descr" => "page 12", "data" => [
          { "type" => "textline", "ypos" => 628.3, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D4q1"} },                       # D4q1
          { "type" => "textflow", "ypos" => 628.3, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD4q1"} },                       # TextD4q1
          { "type" => "textline", "ypos" => 508.5, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D4q2"} },                       # D4q2
          { "type" => "textflow", "ypos" => 508.5, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD4q2"} },                       # TextD4q2
          { "type" => "textline", "ypos" => 385.7, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D4q3"} },                       # D4q3
          { "type" => "textflow", "ypos" => 385.7, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD4q3"} },                       # TextD4q3
          { "type" => "textline", "ypos" => 251.5, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D4q4"} },                       # D4q4
          { "type" => "textflow", "ypos" => 251.5, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD4q4"} },                       # TextD4q4
          { "type" => "textline", "ypos" => 130.1, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D4q5"} },                       # D4q5
          { "type" => "textflow", "ypos" => 130.1, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD4q5"} },                       # TextD4q5
      ] },
      { "descr" => "page 13", "data" => [
          { "type" => "textline", "ypos" => 636, "xpos" => 502.3, "optlist" => "position={center bottom}",
                                "text" => $DBData{"D4q6"} },                       # D4q6
          { "type" => "textflow", "ypos" => 636, "xpos_start" => 129.8, "xpos_end" => 447.6,
                                "text" => $DBData{"TextD4q6"} },                       # TextD4q6
          { "type" => "textline", "ypos" => 584.9, "xpos" => 505.2, "optlist" => "position={center bottom}",
                                "text" => $DBData{"tD4"} },                       # tD4
          { "type" => "checkvert", "xpos" => 358.6, "optlist" => "fontsize=12 position={center bottom}", "yposarray" => [531.6, 519.4, 507.1, 494.9, 482.6],
                                "val" => main->getSeverityRating($DBData{"tD4"}, ([0, 0], [1, 6], [7, 12], [13, 18], [19, 24])) },             # DIMENSION 4 SCORING
          { "type" => "textflow", "ypos" => 460.6, "xpos_start" => 57.4, "xpos_end" => 553.7,
                                "text" => $DBData{"CommentsD4"} },                       # CommentsD4
      ] },
      { "descr" => "page 14", "data" => [
      ] },
    );
  }
  elsif ("$table$page" eq "ClientODASTSLevels") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textline", "ypos" => 706.8, "xpos" => 152.6, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"testdate"} },                       # Date
          { "type" => "textline", "ypos" => 706.8, "xpos" => 420.2, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"clientid"} },                       # Client ID
          { "type" => "textline", "ypos" => 688.6, "xpos" => 105.1, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tD1"} },                       # tD1
          { "type" => "textline", "ypos" => 688.6, "xpos" => 181.9, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tD2"} },                       # tD2
          { "type" => "textline", "ypos" => 688.6, "xpos" => 259.9, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tD3"} },                       # tD3
          { "type" => "textline", "ypos" => 688.6, "xpos" => 336.7, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tD5"} },                       # tD5
          { "type" => "textline", "ypos" => 688.6, "xpos" => 413.5, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tD6"} },                       # tD6
          { "type" => "textline", "ypos" => 688.6, "xpos" => 490.3, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tD4"} },                       # tD4
          { "type" => "textline", "ypos" => 62.9, "xpos" => 181.9, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"clinician"} },                       # Clinician
      ] }
    );
  }
  elsif ("$table$page" eq "ClientODASWMScore") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textline", "ypos" => 697.3, "xpos" => 118.1, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"testdate"} },                       # Date
          { "type" => "textline", "ypos" => 697.3, "xpos" => 451.4, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"clientid"} },                       # Client ID
          { "type" => "textline", "ypos" => 632.8, "xpos" => 245.5, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"tLWM"} },                       # DIMENSION 1 Severity Rating
          { "type" => "textline", "ypos" => 133, "xpos" => 210.2, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"sWMIndicated"} },                       # LEVEL OF SERVICE INDICATED
          { "type" => "textline", "ypos" => 60.2, "xpos" => 179.6, "optlist" => "fontsize=7 position={center bottom}",
                                "text" => $DBData{"clinician"} },                       # Clinician
      ] }
    );
  }
  elsif ("$table$page" eq "ClientTCUDS") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "chararray", "ypos" => 690.2, "xposarray" => [59.8, 77.6, 94.6, 111.6, 128.6, 145.6, 162.6, 179.8, 197],
                                "text" => $DBData{"clientid"} },                       # clientid
          { "type" => "chararray", "ypos" => 690.2, "xposarray" => [455.8, 473, 492, 509.8, 528.7, 546],
                                "text" => $DBData{"testdateMDY"} },                  # testdate
          { "type" => "radio", "ypos" => 613.1, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q1"} },             # q1
          { "type" => "radio", "ypos" => 589.9, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q2"} },             # q2
          { "type" => "radio", "ypos" => 552.7, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q3"} },             # q3
          { "type" => "radio", "ypos" => 529.5, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q4"} },             # q4
          { "type" => "radio", "ypos" => 492.1, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q5"} },             # q5
          { "type" => "radio", "ypos" => 469, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q6"} },             # q6
          { "type" => "radio", "ypos" => 445.9, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q7"} },             # q7
          { "type" => "radio", "ypos" => 422.7, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q8"} },             # q8
          { "type" => "radio", "ypos" => 389.3, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q9"} },             # q9
          { "type" => "radio", "ypos" => 352.6, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q10a"} },             # q10a
          { "type" => "radio", "ypos" => 315.1, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q10b"} },             # q10b
          { "type" => "radio", "ypos" => 277.7, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q11a"} },             # q11a
          { "type" => "radio", "ypos" => 240.4, "xposarray" => [540.5, 495.6],
                                "val" => $DBData{"q11b"} },             # q11b
          { "type" => "radiovertmix", "xposarray" => [72.5, 310.9], "yposarray" => [[192.8, 180.8, 168.8, 156.8, 144.8, 132.8, 120.8, 108.8, 96.8, 84.8], [192.8, 180.8, 168.8, 156.8, 144.8, 132.8, 120.8, 108.8, 96.8]],
                                "val" => $DBData{"q12a"} },             # q12a
          { "type" => "radiotextline", "ypos" => 81, "xpos" => 396, "optlist" => $basefontoptions, "xposradio" => 310.9, "yposradio" => 84.8,
                                "text" => $DBData{"q12b"} },                       # q12b
      ] },
      { "descr" => "page 2", "data" => [
          { "type" => "chararray", "ypos" => 737.6, "xposarray" => [59.8, 77.6, 94.6, 111.6, 128.6, 145.6, 162.6, 179.8, 197],
                                "text" => $DBData{"clientid"} },                       # clientid
          { "type" => "chararray", "ypos" => 737.6, "xposarray" => [455.8, 473, 492, 509.8, 528.7, 546],
                                "text" => $DBData{"testdateMDY"} },                  # testdate
          { "type" => "radio", "ypos" => 622.1, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13a"} },             # q13a
          { "type" => "radio", "ypos" => 604.9, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13b"} },             # q13b
          { "type" => "radio", "ypos" => 587.9, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13c"} },             # q13c
          { "type" => "radio", "ypos" => 570.7, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13d"} },             # q13d
          { "type" => "radio", "ypos" => 553.5, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13e"} },             # q13e
          { "type" => "radio", "ypos" => 536.3, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13f"} },             # q13f
          { "type" => "radio", "ypos" => 519.2, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13g"} },             # q13g
          { "type" => "radio", "ypos" => 502, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13h"} },             # q13h
          { "type" => "radio", "ypos" => 484.9, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13i"} },             # q13i
          { "type" => "radio", "ypos" => 467.6, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13j"} },             # q13j
          { "type" => "radio", "ypos" => 450.6, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13k"} },             # q13k
          { "type" => "radio", "ypos" => 433.4, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13l"} },             # q13l
          { "type" => "radio", "ypos" => 416.3, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13m"} },             # q13m
          { "type" => "radio", "ypos" => 399, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13n"} },             # q13n
          { "type" => "radio", "ypos" => 382, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13o"} },             # q13o
          { "type" => "radio", "ypos" => 364.8, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13p"} },             # q13p
          { "type" => "radio", "ypos" => 347.5, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13q"} },             # q13q
          { "type" => "radio", "ypos" => 330.5, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13r"} },             # q13r
          { "type" => "radio", "ypos" => 313.2, "xposarray" => [355.1, 400.1, 449.6, 499.2, 548.7],
                                "val" => $DBData{"q13s"} },             # q13s
          { "type" => "textline", "ypos" => 310, "xpos" => 148, "optlist" => $basefontoptions,
                                "text" => $DBData{"q13Other"} },                       # q13Other
          { "type" => "radio", "ypos" => 235.4, "xposarray" => [86.4, 158.5, 230.4, 307, 383.4],
                                "val" => $DBData{"q14"} },             # q14
          { "type" => "radio", "ypos" => 185.6, "xposarray" => [86, 171.7, 248, 342.6, 446],
                                "val" => $DBData{"q15"} },             # q15
          { "type" => "radio", "ypos" => 136.3, "xposarray" => [86, 148.9, 261.6, 369.5, 495.5],
                                "val" => $DBData{"q16"} },             # q16
          { "type" => "radio", "ypos" => 87, "xposarray" => [86, 171.6, 248, 342.6, 446],
                                "val" => $DBData{"q17"} },             # q17
      ] }
    );
  }
  elsif ("$table$page" eq "ClientSMFQAdult") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 429.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA1"} },             # qA1
          { "type" => "check", "ypos" => 402.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA2"} },             # qA2
          { "type" => "check", "ypos" => 376.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA3"} },             # qA3
          { "type" => "check", "ypos" => 349.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA4"} },             # qA4
          { "type" => "check", "ypos" => 322.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA5"} },             # qA5
          { "type" => "check", "ypos" => 294.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA6"} },             # qA6
          { "type" => "check", "ypos" => 267.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA7"} },             # qA7
          { "type" => "check", "ypos" => 240.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA8"} },             # qA8
          { "type" => "check", "ypos" => 213.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA9"} },             # qA9
          { "type" => "check", "ypos" => 187.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA10"} },             # qA10
          { "type" => "check", "ypos" => 160.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA11"} },             # qA11
          { "type" => "check", "ypos" => 133.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA12"} },             # qA12
          { "type" => "check", "ypos" => 106.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [437, 499.7, 557.3],
                                "val" => $DBData{"qA13"} },             # qA13
      ] }
    );
  }
  elsif ("$table$page" eq "ClientSMFQChild") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 428.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC1"} },             # qC1
          { "type" => "check", "ypos" => 399, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC2"} },             # qC2
          { "type" => "check", "ypos" => 372.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC3"} },             # qC3
          { "type" => "check", "ypos" => 344.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC4"} },             # qC4
          { "type" => "check", "ypos" => 316.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC5"} },             # qC5
          { "type" => "check", "ypos" => 289.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC6"} },             # qC6
          { "type" => "check", "ypos" => 261.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC7"} },             # qC7
          { "type" => "check", "ypos" => 233.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC8"} },             # qC8
          { "type" => "check", "ypos" => 205.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC9"} },             # qC9
          { "type" => "check", "ypos" => 177.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC10"} },             # qC10
          { "type" => "check", "ypos" => 150.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC11"} },             # qC11
          { "type" => "check", "ypos" => 122, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC12"} },             # qC12
          { "type" => "check", "ypos" => 94.3, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [434.9, 498.2, 557.6],
                                "val" => $DBData{"qC13"} },             # qC13
      ] }
    );
  }
  elsif ("$table$page" eq "ClientSMFQParent") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 432, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP1"} },             # qP1
          { "type" => "check", "ypos" => 405, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP2"} },             # qP2
          { "type" => "check", "ypos" => 377.3, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP3"} },             # qP3
          { "type" => "check", "ypos" => 349.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP4"} },             # qP4
          { "type" => "check", "ypos" => 321.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP5"} },             # qP5
          { "type" => "check", "ypos" => 294.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP6"} },             # qP6
          { "type" => "check", "ypos" => 266.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP7"} },             # qP7
          { "type" => "check", "ypos" => 239.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP8"} },             # qP8
          { "type" => "check", "ypos" => 211.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP9"} },             # qP9
          { "type" => "check", "ypos" => 184.3, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP10"} },             # qP10
          { "type" => "check", "ypos" => 157, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP11"} },             # qP11
          { "type" => "check", "ypos" => 129.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP12"} },             # qP12
          { "type" => "check", "ypos" => 101.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [435.2, 500, 559.1],
                                "val" => $DBData{"qP13"} },             # qP13
      ] }
    );
  }
  elsif ("$table$page" eq "ClientACE") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textlinewithcond", "ypos" => 646.5, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q1"} },             # q1
          { "type" => "textlinewithcond", "ypos" => 571, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q2"} },             # q2
          { "type" => "textlinewithcond", "ypos" => 495.1, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q3"} },             # q3
          { "type" => "textlinewithcond", "ypos" => 419.3, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q4"} },             # q4
          { "type" => "textlinewithcond", "ypos" => 343.4, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q5"} },             # q5
          { "type" => "textlinewithcond", "ypos" => 305.3, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q6"} },             # q6
          { "type" => "textlinewithcond", "ypos" => 204.2, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q7"} },             # q7
          { "type" => "textlinewithcond", "ypos" => 166.3, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q8"} },             # q8
          { "type" => "textlinewithcond", "ypos" => 128.2, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q9"} },             # q9
          { "type" => "textlinewithcond", "ypos" => 90.2, "xpos" => 475.2, "cond" => "gt0", "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"q10"} },             # q10
          { "type" => "textline", "ypos" => 64.3, "xpos" => 298.3, "optlist" => "$baselargefontoptions position={center bottom}",
                                "text" => $DBData{"total"} },             # total
      ] }
    );
  }
  elsif ("$table$page" eq "ClientCATSCaregiver") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textline", "ypos" => 712.1, "xpos" => 171.6, "optlist" => $basefontoptions,
                                "text" => $DBData{"clientname"} },             # Childs Name
          { "type" => "textline", "ypos" => 689.8, "xpos" => 171.6, "optlist" => $basefontoptions,
                                "text" => $DBData{"clinician"} },             # Caregiver Name
          { "type" => "textline", "ypos" => 712.1, "xpos" => 487.2, "optlist" => "$basefontoptions position={center bottom}",
                                "text" => $DBData{"testdate"} },             # Date
          { "type" => "check", "ypos" => 612.2, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA1"} },             # CqA1
          { "type" => "check", "ypos" => 577.2, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA2"} },             # CqA2
          { "type" => "check", "ypos" => 547.2, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA3"} },             # CqA3
          { "type" => "check", "ypos" => 526.8, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA4"} },             # CqA4
          { "type" => "check", "ypos" => 506.6, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA5"} },             # CqA5
          { "type" => "check", "ypos" => 475, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA6"} },             # CqA6
          { "type" => "check", "ypos" => 443.8, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA7"} },             # CqA7
          { "type" => "check", "ypos" => 412.1, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA8"} },             # CqA8
          { "type" => "check", "ypos" => 380.6, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA9"} },             # CqA9
          { "type" => "check", "ypos" => 349, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA10"} },             # CqA10
          { "type" => "check", "ypos" => 329, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA11"} },             # CqA11
          { "type" => "check", "ypos" => 308.6, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA12"} },             # CqA12
          { "type" => "check", "ypos" => 277.2, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA13"} },             # CqA13
          { "type" => "check", "ypos" => 257, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA14"} },             # CqA14
          { "type" => "check", "ypos" => 236.6, "optlist" => "position={center bottom}", "xposarray" => [496.6, 419.8],
                                "val" => $DBData{"CqA15"} },             # CqA15
          { "type" => "textline", "ypos" => 211.3, "xpos" => 174, "optlist" => $basefontoptions,
                                "text" => $DBData{"CDescribe"} },             # CDescribe
          { "type" => "textline", "ypos" => 173.3, "xpos" => 301.7, "optlist" => $basefontoptions,
                                "text" => $DBData{"CTopOne"} },             # Which one is bothering the child most now?
      ] },
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 687.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB1"} },             # CqB1
          { "type" => "check", "ypos" => 655.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB2"} },             # CqB2
          { "type" => "check", "ypos" => 638.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB3"} },             # CqB3
          { "type" => "check", "ypos" => 619.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB4"} },             # CqB4
          { "type" => "check", "ypos" => 601.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB5"} },             # CqB5
          { "type" => "check", "ypos" => 570.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB6"} },             # CqB6
          { "type" => "check", "ypos" => 538.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB7"} },             # CqB7
          { "type" => "check", "ypos" => 506.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB8"} },             # CqB8
          { "type" => "check", "ypos" => 476.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB9"} },             # CqB9
          { "type" => "check", "ypos" => 444.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB10"} },             # CqB10
          { "type" => "check", "ypos" => 412.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB11"} },             # CqB11
          { "type" => "check", "ypos" => 381.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB12"} },             # CqB12
          { "type" => "check", "ypos" => 349.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB13"} },             # CqB13
          { "type" => "check", "ypos" => 331.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB14"} },             # CqB14
          { "type" => "check", "ypos" => 300.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB15"} },             # CqB15
          { "type" => "check", "ypos" => 269, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB16"} },             # CqB16
          { "type" => "check", "ypos" => 250.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB17"} },             # CqB17
          { "type" => "check", "ypos" => 232.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB18"} },             # CqB18
          { "type" => "check", "ypos" => 214.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB19"} },             # CqB19
          { "type" => "check", "ypos" => 196.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [489.8, 516, 541.4, 567.4],
                                "val" => $DBData{"CqB20"} },             # CqB20
          { "type" => "check", "ypos" => 142.8, "optlist" => "position={center bottom}", "xposarray" => [210.7, 269.5],
                                "val" => $DBData{"CqC1"} },             # CqC1
          { "type" => "check", "ypos" => 125.8, "optlist" => "position={center bottom}", "xposarray" => [210.7, 269.5],
                                "val" => $DBData{"CqC2"} },             # CqC2
          { "type" => "check", "ypos" => 108.5, "optlist" => "position={center bottom}", "xposarray" => [210.7, 269.5],
                                "val" => $DBData{"CqC3"} },             # CqC3
          { "type" => "check", "ypos" => 142.8, "optlist" => "position={center bottom}", "xposarray" => [530.6, 481.2],
                                "val" => $DBData{"CqC4"} },             # CqC4
          { "type" => "check", "ypos" => 125.8, "optlist" => "position={center bottom}", "xposarray" => [530.6, 481.2],
                                "val" => $DBData{"CqC5"} },             # CqC5
      ] }
    );
  }
  elsif ("$table$page" eq "ClientCATSYouth") {
    @PageData = (
      { "descr" => "page 1", "data" => [
          { "type" => "textline", "ypos" => 712.1, "xpos" => 136.3, "optlist" => $basefontoptions,
                                "text" => $DBData{"clientname"} },             # Childs Name
          { "type" => "textline", "ypos" => 712.1, "xpos" => 396.2, "optlist" => "$basefontoptions position={center bottom}",
                                "text" => $DBData{"testdate"} },             # Date
          { "type" => "check", "ypos" => 646.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA1"} },             # qA1
          { "type" => "check", "ypos" => 617.3, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA2"} },             # qA2
          { "type" => "check", "ypos" => 585.4, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA3"} },             # qA3
          { "type" => "check", "ypos" => 566.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA4"} },             # qA4
          { "type" => "check", "ypos" => 546.2, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA5"} },             # qA5
          { "type" => "check", "ypos" => 514.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA6"} },             # qA6
          { "type" => "check", "ypos" => 483.1, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA7"} },             # qA7
          { "type" => "check", "ypos" => 451.7, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA8"} },             # qA8
          { "type" => "check", "ypos" => 420, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA9"} },             # qA9
          { "type" => "check", "ypos" => 388.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA10"} },             # qA10
          { "type" => "check", "ypos" => 368.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA11"} },             # qA11
          { "type" => "check", "ypos" => 348.5, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA12"} },             # qA12
          { "type" => "check", "ypos" => 316.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA13"} },             # qA13
          { "type" => "check", "ypos" => 296.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA14"} },             # qA14
          { "type" => "check", "ypos" => 276.7, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [420.7, 500.9],
                                "val" => $DBData{"qA15"} },             # qA15
          { "type" => "textline", "ypos" => 248.2, "xpos" => 161.8, "optlist" => $basefontoptions,
                                "text" => $DBData{"Describe"} },             # Describe
          { "type" => "textline", "ypos" => 209.8, "xpos" => 292.6, "optlist" => $basefontoptions,
                                "text" => $DBData{"TopOne"} },             # Which one is bothering the child most now?
      ] },
      { "descr" => "page 1", "data" => [
          { "type" => "check", "ypos" => 666.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB1"} },             # qB1
          { "type" => "check", "ypos" => 643.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB2"} },             # qB2
          { "type" => "check", "ypos" => 625, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB3"} },             # qB3
          { "type" => "check", "ypos" => 606, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB4"} },             # qB4
          { "type" => "check", "ypos" => 587.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB5"} },             # qB5
          { "type" => "check", "ypos" => 558.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB6"} },             # qB6
          { "type" => "check", "ypos" => 526.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB7"} },             # qB7
          { "type" => "check", "ypos" => 494.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB8"} },             # qB8
          { "type" => "check", "ypos" => 475.9, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB9"} },             # qB9
          { "type" => "check", "ypos" => 445.2, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB10"} },             # qB10
          { "type" => "check", "ypos" => 413.5, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB11"} },             # qB11
          { "type" => "check", "ypos" => 394.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB12"} },             # qB12
          { "type" => "check", "ypos" => 376.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB13"} },             # qB13
          { "type" => "check", "ypos" => 357.6, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB14"} },             # qB14
          { "type" => "check", "ypos" => 339.1, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB15"} },             # qB15
          { "type" => "check", "ypos" => 320.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB16"} },             # qB16
          { "type" => "check", "ypos" => 301.7, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB17"} },             # qB17
          { "type" => "check", "ypos" => 279.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB18"} },             # qB18
          { "type" => "check", "ypos" => 261.4, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB19"} },             # qB19
          { "type" => "check", "ypos" => 242.8, "optlist" => "fontsize=15 position={center bottom}", "xposarray" => [488.6, 512.9, 535.9, 559.4],
                                "val" => $DBData{"qB20"} },             # qB20
          { "type" => "textline", "ypos" => 223.7, "xpos" => 548.6, "optlist" => "$basefontoptions position={center bottom}",
                                "text" => $DBData{"total"} },             # total
          { "type" => "check", "ypos" => 173.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [210, 273.1],
                                "val" => $DBData{"qC1"} },             # qC1
          { "type" => "check", "ypos" => 151.2, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [210, 273.1],
                                "val" => $DBData{"qC2"} },             # qC2
          { "type" => "check", "ypos" => 125.1, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [210, 273.1],
                                "val" => $DBData{"qC3"} },             # qC3
          { "type" => "check", "ypos" => 173.6, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [467.8, 534.2],
                                "val" => $DBData{"qC4"} },             # qC4
          { "type" => "check", "ypos" => 151.2, "optlist" => "fontsize=12 position={center bottom}", "xposarray" => [467.8, 534.2],
                                "val" => $DBData{"qC5"} },             # qC5
      ] }
    );
  }
  elsif ("$table$page" eq "ClientCATSScore") {
    @PageData = (
      { "descr" => "page 1", "data" => [

      ] }
    );
  }
#####################
  for (my $pageno = 1; $pageno <= $no_of_input_pages; $pageno++) {
    $p->begin_page_ext($pagewidth, $pageheight, "");
    $p->fit_pdi_page($pagehandles[$pageno], 0, 0, "cloneboxes");
    foreach (@{$PageData[$pageno-1]->{"data"}}) {
      main->renderObject($p, $_);
    }
    $p->end_page_ext("");
    $pagecount++;
  }
}

############################################################################
sub getSeverityRating {
  my ($self, $score, @rowscores) = @_;
  my $rating = 0;

  foreach (@rowscores) {
    my $min = @{$_}[0];
    my $max = @{$_}[1];

    last if ($score >= $min && $score <= $max);
    
    $rating++;
  }

  return $rating;
}

sub renderObject {
  my ($self, $p, $obj) = @_;

  if ($obj->{"type"} eq "textline") {
    main->renderTextline($p,
      $obj->{"text"}, $obj->{"xpos"}, $obj->{"ypos"}, $obj->{"optlist"});
  }

  if ($obj->{"type"} eq "textlinewithcond") {
    main->renderTextlineWithCond($p,
      $obj->{"text"}, $obj->{"cond"}, $obj->{"xpos"}, $obj->{"ypos"}, $obj->{"optlist"});
  }

  if ($obj->{"type"} eq "textflow") {
    main->renderTextflow($p,
      $obj->{"text"}, $obj->{"xpos_start"}, $obj->{"xpos_end"}, $obj->{"ypos"},
      $obj->{"optlist"}, $obj->{"optlist2"});
  }

  if ($obj->{"type"} eq "check") {
    main->renderCheck($p,
      $obj->{"val"}, $obj->{"xposarray"}, $obj->{"ypos"}, $obj->{"optlist"}, $obj->{"text"});
  }

  if ($obj->{"type"} eq "checkvert") {
    main->renderCheckVert($p,
      $obj->{"val"}, $obj->{"xpos"}, $obj->{"yposarray"}, $obj->{"optlist"}, $obj->{"text"});
  }

  if ($obj->{"type"} eq "chararray") {
    main->renderCharArray($p,
      $obj->{"text"}, $obj->{"ypos"}, $obj->{"optlist"}, @{$obj->{"xposarray"}});
  }

  if ($obj->{"type"} eq "radio") {
    main->renderRadio($p,
      $obj->{"val"}, $obj->{"xposarray"}, $obj->{"ypos"}, $obj->{"radius"});
  }

  if ($obj->{"type"} eq "radiovertmix") {
    main->renderRadioVertMix($p,
      $obj->{"val"}, $obj->{"xposarray"}, $obj->{"yposarray"}, $obj->{"radius"});
  }

  if ($obj->{"type"} eq "radiotextline") {
    main->renderRadioTextline($p,
      $obj->{"text"}, $obj->{"xpos"}, $obj->{"ypos"}, $obj->{"optlist"}, $obj->{"xposradio"}, $obj->{"yposradio"}, $obj->{"radius"});
  }

}

sub openPdiPages {
  my ($self, $p) = @_;

#warn qq|no_of_input_pages: ${no_of_input_pages}\n|;
  # Prepare all pages of the input document. We assume a small
  # number of input pages and a large number of generated output
  # pages. Therefore it makes sense to keep the input pages
  # open instead of opening the pages again for each encounter.
    
  for (my $pageno = 1; $pageno <= $no_of_input_pages; $pageno++)
  {
    # Open the first page and clone the page size 
    $pagehandles[$pageno] = $p->open_pdi_page($indoc, $pageno, "cloneboxes");
    if ($pagehandles[$pageno] == -1) { die("Error: " . $p->get_errmsg()); }
  }
}

sub closePdiPages {
  my ($self, $p) = @_;

  # Close all input pages 
  for (my $pageno = 1; $pageno <= $no_of_input_pages; $pageno++)
  { $p->close_pdi_page($pagehandles[$pageno]); }
  $p->close_pdi_document($indoc);
}

#### renderTextline
# Renders text line
#
## Params
# text => string
# xpos => x-position of text
# ypos => y-position of text
# optlist => option list of text
####
sub renderTextline {
  my ($self, $p, $text, $xpos, $ypos, $optlist) = @_;

  $p->fit_textline($text, $xpos, $ypos, $basesmallfontoptions . " " . ($optlist ? $optlist : ""));
}

#### renderTextlineWithCond
# Renders text line if condition is match
#
## Params
# text => string
# cond => condition to render text
# xpos => x-position of text
# ypos => y-position of text
# optlist => option list of text
####
sub renderTextlineWithCond {
  my ($self, $p, $text, $cond, $xpos, $ypos, $optlist) = @_;

  my $match = 0;

  if ($cond eq 'notnull' && $text ne '') {
    $match = 1;
  }
  elsif ($cond eq 'gt0' && int($text) > 0) {
    $match = 1;
  }

  if ($match) {
    main->renderTextline($p, $text, $xpos, $ypos, $optlist);
  }
}

#### renderTextflow
# Renders text flow
#
## Params
# text => string
# xpos_start => start x-position of textflow area (left top of textflow rectangle)
# xpos_end => end x-position of textflow area (right top of textflow rectangle)
# ypos => top position of textflow rectangle
# optlist => option list of create_textflow
# optlist2 => option list of fit_textflow
####
sub renderTextflow {
  my ($self, $p, $text, $xpos_start, $xpos_end, $ypos, $optlist, $optlist2) = @_;
  
  my $tf;
  my $result;

  $tf = $p->create_textflow($text, $basesmallfontoptions . " leading=155% " . ($optlist ? $optlist : ""));
  $p->fit_textflow($tf, $xpos_start, $y_bottom, $xpos_end, $ypos, ($optlist2 ? $optlist2 : ""));
}

#### renderCheck
# Renders horizontally aligned check marks that select only one check
#
## Params 
# val => index of the selected check mark
# xposarray => x-position array of check marks
# ypos => y-position of check marks
# optlist => option list of check mark
# text => check mark
#         e.g: &#x2713; (check mark)
#              X (X check mark)
####
sub renderCheck {
  my ($self, $p, $val, $xposarray, $ypos, $optlist, $text) = @_;

  if ($val ne '') {
    $p->fit_textline(($text eq '' ? '&#x2713;' : $text), @{$xposarray}[int($val)], $ypos, $basecheckfontoptions . " " . ($optlist ? $optlist : ""));
  }
}

#### renderCheckVert
# Renders vertically aligned check marks that select only one check
#
## Params 
# val => index of the selected check mark
# xpos => x-position of check marks
# yposarray => y-position array of check marks
# optlist => option list of check marks
# text => check mark
#         e.g: &#x2713; (check mark)
#              X (X check mark)
####
sub renderCheckVert {
  my ($self, $p, $val, $xpos, $yposarray, $optlist, $text) = @_;

  if ($val ne '') {
    $p->fit_textline(($text eq '' ? '&#x2713;' : $text), $xpos, @{$yposarray}[int($val)], $basecheckfontoptions . " " . ($optlist ? $optlist : ""));
  }
}

#### renderCharArray
# Renders text one by one with character positions
#
# Default option of character: basefontoption, position={center bottom}
#
## Params
# text => string
# ypos => y-position of text
# optlist => option list of character
# xposarray => x-position array of characters of text
####
sub renderCharArray {
  my ($self, $p, $text, $ypos, $optlist, @xposarray) = @_;
  
  my $char;

  foreach my $i (0..$#xposarray) {
    $char = substr($text, $i, 1);

    if ($char ne '') {
      $p->fit_textline($char, $xposarray[$i], $ypos, "$basefontoptions position={center bottom} " . ($optlist ? $optlist : ""))
    }
  }
}

#### renderCircle
# Renders black dot
#
## Params
# xpos => x-position of circle center
# ypos => y-position of circle center
# radius => radius of circle
#           Default: 2
####
sub renderCircle {
  my ($self, $p, $xpos, $ypos, $radius) = @_;

  $p->setcolor('fill', 'rgb', 0.0, 0.0, 0.0, 0.0);
  $p->circle($xpos, $ypos, ($radius ? $radius : 2));
  $p->fill();
}

#### renderRadio
# Renders horizontally aligned radios that select only one radio
#
## Params
# val => index of the selected radio
# xposarray => x-position array of radios
# ypos => y-position of radios
# radius => radius of radio
#           Default: 2
####
sub renderRadio {
  my ($self, $p, $val, $xposarray, $ypos, $radius) = @_;

  if ($val ne '') {
    main->renderCircle($p, @{$xposarray}[int($val)], $ypos, $radius);
  }
}

#### renderRadioVertMix
# Renders vertically aligned radios having multiple columns that select only one radio
#
## Params
# val => index of the selected radio
# xposarray => x-position array of radios
# yposarray => y-position array of radios (the nested array of xposarray means each column)
#              [[...column1...], [...column2...], [...column3...], ...]
# radius => radius of radio
#           Default: 2
####
sub renderRadioVertMix {
  my ($self, $p, $val, $xposarray, $yposarray, $radius) = @_;

  my @posarray = ();
  my $i = 0;
  foreach my $xpos (@{$xposarray}) {
    foreach my $ypos (@{@{$yposarray}[$i]}) {
      push(@posarray, [$xpos, $ypos]);
    }
    $i++;
  }

  if ($val ne '') {
    my $pos = $posarray[int($val)];
    main->renderCircle($p, @{$pos}[0], @{$pos}[1], $radius);
  }
}

#### renderRadioTextline
# Renders textline with radio if the text is not null
# Renders radio only if text is not null
# 
## Params
# xpos => x-position of text
# ypos => y-position of text
# optlist => option list of text
# xposradio => x-position of radio center
# yposradio => y-position of radio center
# radius => radius of radio
#           Default: 2
####
sub renderRadioTextline {
  my ($self, $p, $text, $xpos, $ypos, $optlist, $xposradio, $yposradio, $radius) = @_;

  if ($text ne '') {
    main->renderTextline($p, $text, $xpos, $ypos, $optlist);
    main->renderCircle($p, $xposradio, $yposradio, $radius);
  }
}
